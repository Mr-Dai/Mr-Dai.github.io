<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Groovy 教程 - GDK - Robert Peng&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="呆呆的博客"><meta name="msapplication-TileImage" content="/img/avatar.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="呆呆的博客"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="这是一篇译文，读者可前往 Groovy Getting Started - The Groovy Development Kit 阅读原文。"><meta property="og:type" content="blog"><meta property="og:title" content="Groovy 教程 - GDK"><meta property="og:url" content="https://mr-dai.github.io/groovy-dev-kit/"><meta property="og:site_name" content="Robert Peng&#039;s Blog"><meta property="og:description" content="这是一篇译文，读者可前往 Groovy Getting Started - The Groovy Development Kit 阅读原文。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://mr-dai.github.io/img/og_image.png"><meta property="article:published_time" content="2018-04-23T16:00:00.000Z"><meta property="article:modified_time" content="2018-04-23T16:00:00.000Z"><meta property="article:author" content="Robert Peng"><meta property="article:tag" content="Groovy"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mr-dai.github.io/groovy-dev-kit/"},"headline":"Groovy 教程 - GDK","image":["https://mr-dai.github.io/img/og_image.png"],"datePublished":"2018-04-23T16:00:00.000Z","dateModified":"2018-04-23T16:00:00.000Z","author":{"@type":"Person","name":"Robert Peng"},"publisher":{"@type":"Organization","name":"Robert Peng's Blog","logo":{"@type":"ImageObject","url":"https://mr-dai.github.io/img/avatar.png"}},"description":"这是一篇译文，读者可前往 Groovy Getting Started - The Groovy Development Kit 阅读原文。"}</script><link rel="canonical" href="https://mr-dai.github.io/groovy-dev-kit/"><link rel="icon" href="/img/avatar.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/avatar.png" alt="Robert Peng&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="我的 Github" href="https://github.com/Mr-Dai"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-04-23T16:00:00.000Z" title="4/23/2018, 4:00:00 PM">2018-04-24</time>发表</span><span class="level-item"><time dateTime="2018-04-23T16:00:00.000Z" title="4/23/2018, 4:00:00 PM">2018-04-24</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Groovy/">Groovy</a></span></div></div><h1 class="title is-3 is-size-4-mobile">Groovy 教程 - GDK</h1><div class="content"><p>这是一篇译文，读者可前往 <a target="_blank" rel="noopener" href="http://www.groovy-lang.org/groovy-dev-kit.html">Groovy Getting Started - The Groovy Development Kit</a> 阅读原文。</p>
<span id="more"></span>

<h2 id="1-I-O"><a href="#1-I-O" class="headerlink" title="1 I/O"></a>1 I/O</h2><!-- Groovy provides a number of helper methods for working with I/O. While you could use standard Java code in Groovy to deal with those, Groovy provides much more convenient ways to handle files, streams, readers, …​ -->
<p>Groovy 为 I/O 提供了大量的<a target="_blank" rel="noopener" href="http://groovy-lang.org/gdk.html">便捷方法</a>。尽管你仍然可以在 Groovy 中使用标准的 Java 代码，但 Groovy 提供了更多方便的途径来处理文件、流等。</p>
<p>具体来说，你应该了解一下添加至如下类的方法：</p>
<ul>
<li><code>java.io.File</code>：<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/File.html">http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/File.html</a></li>
<li><code>java.io.InputStream</code>：<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/InputStream.html">http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/InputStream.html</a></li>
<li><code>java.io.OutputStream</code>：<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/OutputStream.html">http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/OutputStream.html</a></li>
<li><code>java.io.Reader</code>：<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/Reader.html">http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/Reader.html</a></li>
<li><code>java.io.Writer</code>：<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/Writer.html">http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/Writer.html</a></li>
<li><code>java.nio.file.Path</code>：<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/nio/file/Path.html">http://docs.groovy-lang.org/latest/html/groovy-jdk/java/nio/file/Path.html</a></li>
</ul>
<!-- The following section focuses on sample idiomatic constructs using helper methods available above but is not meant to be a complete description of all available methods. For that, please read the GDK API. -->
<p>接下来的内容将重点介绍如何使用上述便捷方法但并不会对所有的这些方法进行完整描述，具体请查阅 <a target="_blank" rel="noopener" href="http://groovy-lang.org/gdk.html">GDK API</a>。</p>
<h3 id="1-1-读取文件"><a href="#1-1-读取文件" class="headerlink" title="1.1 读取文件"></a>1.1 读取文件</h3><!-- As a first example, let’s see how you would print all lines of a text file in Groovy: -->
<p>在第一个例子中，我们先来看看如何在 Groovy 中打印一个文本文件中的内容：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir, <span class="string">&#x27;haiku.txt&#x27;</span>).eachLine &#123; line -&gt;</span><br><span class="line">    println line</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<!-- The eachLine method is a method added to the File class automatically by Groovy and has many variants, for example if you need to know the line number, you can use this variant: -->
<p><code>eachLine</code> 方法是由 Groovy 自动添加到 <code>File</code> 类中的新方法而且有很多的变体，例如如果你想要知道文件的行号，你可以使用如下这个变体：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir, <span class="string">&#x27;haiku.txt&#x27;</span>).eachLine &#123; line, nb -&gt;</span><br><span class="line">    println <span class="string">&quot;Line $nb: $line&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<!-- If for whatever reason the an exception is thrown in the eachLine body, the method makes sure that the resource is properly closed. This is true for all I/O resource methods that Groovy adds. -->
<p>如果 <code>eachLine</code> 的方法体抛出了异常的话，<code>eachLine</code> 方法会确保所有相关资源都被正确地关闭。这一点对于所有由 Groovy 添加的 I/O 方法来说都是相同的。</p>
<!-- For example in some cases you will prefer to use a Reader, but still benefit from the automatic resource management from Groovy. In the next example, the reader will be closed even if the exception occurs: -->
<p>例如在某些时候你更想使用 <code>Reader</code>，但依然想利用上 Groovy 的自动资源管理。在下面的例子中，即使抛出了异常，所使用的 <code>Reader</code> 依然会被关闭：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> count = <span class="number">0</span>, MAXSIZE = <span class="number">3</span></span><br><span class="line"><span class="keyword">new</span> File(baseDir,<span class="string">&quot;haiku.txt&quot;</span>).withReader &#123; reader -&gt;</span><br><span class="line">    <span class="keyword">while</span> (reader.readLine()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (++count &gt; MAXSIZE) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&#x27;Haiku should only have 3 verses&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果你需要将一个文本文件的每一行内容放入到一个列表中，你可以这样做：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = <span class="keyword">new</span> File(baseDir, <span class="string">&#x27;haiku.txt&#x27;</span>).collect &#123;it&#125;</span><br></pre></td></tr></table></figure>

<p>或者你也可以使用 <code>as</code> 操作符将文本文件每一行的内容放入到一个数组中：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> array = <span class="keyword">new</span> File(baseDir, <span class="string">&#x27;haiku.txt&#x27;</span>) <span class="keyword">as</span> String[]</span><br></pre></td></tr></table></figure>

<!-- How many times did you have to get the contents of a file into a byte[] and how much code does it require? Groovy makes it very easy actually: -->
<p>你有试过把文件的内容读入到一个 <code>byte[]</code> 中吗？这么做需要写多少代码呢？Groovy 则使得这么做变得十分简单：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">byte</span>[] contents = file.bytes</span><br></pre></td></tr></table></figure>

<!-- Working with I/O is not limited to dealing with files. In fact, a lot of operations rely on input/output streams, hence why Groovy adds a lot of support methods to those, as you can see in the documentation. -->
<p>I/O 功能并不局限于文件读写。实际上，很大一部分操作依赖于输入输出流，因此 Groovy 为它们添加了大量的便捷方法，正如你在它们的<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/io/InputStream.html">文档</a>中看到的那样。</p>
<!-- As an example, you can obtain an InputStream from a File very easily: -->
<p>例如，你很容易就能够从一个 <code>File</code> 中获取一个 <code>InputStream</code>：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> is = <span class="keyword">new</span> File(baseDir,<span class="string">&#x27;haiku.txt&#x27;</span>).newInputStream()</span><br><span class="line"><span class="comment">// 做一些事情 ...</span></span><br><span class="line">is.close()</span><br></pre></td></tr></table></figure>

<!-- However you can see that it requires you to deal with closing the inputstream. In Groovy it is in general a better idea to use the withInputStream idiom that will take care of that for you: -->
<p>然而，正如你所看到的那样，这样做会需要你自己关闭这个 <code>InputStream</code>。实际上，在 Groovy 中使用 <code>withInputStream</code> 方法来处理资源管理是更好的选择：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir,<span class="string">&#x27;haiku.txt&#x27;</span>).withInputStream &#123; stream -&gt;</span><br><span class="line">    <span class="comment">// 做一些事情 ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-写入文件"><a href="#1-2-写入文件" class="headerlink" title="1.2 写入文件"></a>1.2 写入文件</h3><!-- Of course in some cases you won’t want to read but write a file. One of the options is to use a Writer: -->
<p>当然了，在某些情况下你可能会想要往文件中写入内容而不是读取内容。其中一种做法是使用 <code>Writer</code>：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir,<span class="string">&#x27;haiku.txt&#x27;</span>).withWriter(<span class="string">&#x27;utf-8&#x27;</span>) &#123; writer -&gt;</span><br><span class="line">    writer.writeLine <span class="string">&#x27;Into the ancient pond&#x27;</span></span><br><span class="line">    writer.writeLine <span class="string">&#x27;A frog jumps&#x27;</span></span><br><span class="line">    writer.writeLine <span class="string">&#x27;Water’s sound!&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<!-- But for such a simple example, using the << operator would have been enough: -->
<p>但对于这么简单的功能，使用 <code>&lt;&lt;</code> 运算符也许也足够了：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir,<span class="string">&#x27;haiku.txt&#x27;</span>) &lt;&lt; <span class="string">&#x27;&#x27;&#x27;Into the ancient pond</span></span><br><span class="line"><span class="string">A frog jumps</span></span><br><span class="line"><span class="string">Water’s sound!&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<!-- Of course we do not always deal with text contents, so you could use the Writer or directly write bytes as in this example: -->
<p>当然了，我们并不总是只需要处理文本内容，所以你也可以使用 <code>Writer</code> 或者像如下示例那样直接写入字节：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file.bytes = [<span class="number">66</span>,<span class="number">22</span>,<span class="number">11</span>]</span><br></pre></td></tr></table></figure>

<!-- Of course you can also directly deal with output streams. For example, here is how you would create an output stream to write into a file: -->
<p>当然，你也可以直接处理输出流。例如，你可以像这个样子来创建一个能写入到文件的输出流：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> os = <span class="keyword">new</span> File(baseDir,<span class="string">&#x27;data.bin&#x27;</span>).newOutputStream()</span><br><span class="line"><span class="comment">// 做一些事情 ...</span></span><br><span class="line">os.close()</span><br></pre></td></tr></table></figure>

<!-- However you can see that it requires you to deal with closing the output stream. Again it is in general a better idea to use the withOutputStream idiom that will handle the exceptions and close the stream in any case: -->
<p>然而，正如你所见，这么做需要你自己关闭该输出流。同样，使用 <code>withOutputStream</code> 方法是更好的做法，因为它能处理抛出的异常并最终能在任何情况下关闭输出流：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir,<span class="string">&#x27;data.bin&#x27;</span>).withOutputStream &#123; stream -&gt;</span><br><span class="line">    <span class="comment">// 做一些事情 ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-遍历文件树"><a href="#1-3-遍历文件树" class="headerlink" title="1.3 遍历文件树"></a>1.3 遍历文件树</h3><!-- In scripting contexts it is a common task to traverse a file tree in order to find some specific files and do something with them. Groovy provides multiple methods to do this. For example you can perform something on all files of a directory: -->
<p>在编写脚本的时候我们经常会需要遍历文件树来找到某些特定的文件并进行一些处理。Groovy 为此提供了多种不同的方法。例如你可以对文件夹中的所有文件执行指定的操作：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dir.eachFile &#123; file -&gt;                      <span class="comment">// 注1</span></span><br><span class="line">    println file.name</span><br><span class="line">&#125;</span><br><span class="line">dir.eachFileMatch(<span class="regexp">~/.*\.txt/</span>) &#123; file -&gt;     <span class="comment">// 注2</span></span><br><span class="line">    println file.name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table style="width: 100%">
    <colgroup>
        <col style="width: 5%">
        <col style="width: 95%">
    </colgroup>

<pre><code>&lt;tr&gt;
    &lt;td&gt;1&lt;/td&gt;
    &lt;td&gt;对文件夹中的所有文件执行给定的闭包代码&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;2&lt;/td&gt;
    &lt;td&gt;对文件夹中所有匹配指定模式的文件执行给定的闭包代码&lt;/td&gt;
&lt;/tr&gt;
</code></pre>
</table>

<!-- Often you will have to deal with a deeper hierarchy of files, in which case you can use eachFileRecurse: -->
<p>有时你还需要处理更深的文件层次，这时候你就需要使用 <code>eachFileRecurse</code> 了：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dir.eachFileRecurse &#123; file -&gt;                      <span class="comment">// 注1</span></span><br><span class="line">    println file.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dir.eachFileRecurse(FileType.FILES) &#123; file -&gt;      <span class="comment">// 注2</span></span><br><span class="line">    println file.name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
    <colgroup>
        <col style="width: 5%">
        <col style="width: 95%">
    </colgroup>

<pre><code>&lt;tr&gt;
    &lt;td&gt;1&lt;/td&gt;
    &lt;td&gt;从该目录开始递归地查找所有文件或目录并执行指定的闭包代码&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;2&lt;/td&gt;
    &lt;td&gt;从该目录开始递归地查找所有文件并执行指定的闭包代码&lt;/td&gt;
&lt;/tr&gt;
</code></pre>
</table>

<!-- For more complex traversal techniques you can use the traverse method, which requires you to set a special flag indicating what to do with the traversal: -->
<p>对于更复杂的遍历操作你可以使用 <code>traverse</code> 方法，这需要你要返回特殊的标识位来指示如何进行遍历：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dir.traverse &#123; file -&gt;</span><br><span class="line">    <span class="keyword">if</span> (file.directory &amp;&amp; file.name==<span class="string">&#x27;bin&#x27;</span>) &#123;</span><br><span class="line">        FileVisitResult.TERMINATE                   <span class="comment">// 注1</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        println file.name</span><br><span class="line">        FileVisitResult.CONTINUE                    <span class="comment">// 注2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
    <colgroup>
        <col style="width: 5%">
        <col style="width: 95%">
    </colgroup>
    <tr>
        <td>1</td>
        <td>如果该文件为一个文件夹且名称为 `bin` 则停止遍历</td>
    </tr>
    <tr>
        <td>2</td>
        <td>否则打印文件的名称并继续遍历</td>
    </tr>
</table>

<h3 id="1-4-数据与对象"><a href="#1-4-数据与对象" class="headerlink" title="1.4 数据与对象"></a>1.4 数据与对象</h3><!-- In Java it is not uncommon to serialize and deserialize data using the java.io.DataOutputStream and java.io.DataInputStream classes respectively. Groovy will make it even easier to deal with them. For example, you could serialize data into a file and deserialize it using this code: -->
<p>在 Java 中，通过 <code>java.io.DataOutputStream</code> 和 <code>java.io.DataInputStream</code> 类来对数据进行序列化和反序列化并不少见，而 Groovy 则让这个过程变得更为简单。例如，你可以使用如下代码来将数据序列化到文件中并读取：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">boolean</span> b = <span class="literal">true</span></span><br><span class="line">String message = <span class="string">&#x27;Hello from Groovy&#x27;</span></span><br><span class="line"><span class="comment">// 将数据序列化至一个文件</span></span><br><span class="line">file.withDataOutputStream &#123; out -&gt;</span><br><span class="line">    out.writeBoolean(b)</span><br><span class="line">    out.writeUTF(message)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// 然后重新读取回来</span></span><br><span class="line">file.withDataInputStream &#123; input -&gt;</span><br><span class="line">    <span class="keyword">assert</span> input.readBoolean() == b</span><br><span class="line">    <span class="keyword">assert</span> input.readUTF() == message</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<!-- And similarily, if the data you want to serialize implements the Serializable interface, you can proceed with an object output stream, as illustrated here: -->
<p>同样的，如果你想要序列化的数据实现了 <code>Serializable</code> 接口，你还可以像如下代码那样使用 <code>ObjectOutputStream</code>：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Person p = <span class="keyword">new</span> Person(<span class="attr">name:</span><span class="string">&#x27;Bob&#x27;</span>, <span class="attr">age:</span><span class="number">76</span>)</span><br><span class="line"><span class="comment">// 将数据序列化至一个文件</span></span><br><span class="line">file.withObjectOutputStream &#123; out -&gt;</span><br><span class="line">    out.writeObject(p)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// 然后读取回来</span></span><br><span class="line">file.withObjectInputStream &#123; input -&gt;</span><br><span class="line">    <span class="keyword">def</span> p2 = input.readObject()</span><br><span class="line">    <span class="keyword">assert</span> p2.name == p.name</span><br><span class="line">    <span class="keyword">assert</span> p2.age == p.age</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-5-执行外部进程"><a href="#1-5-执行外部进程" class="headerlink" title="1.5 执行外部进程"></a>1.5 执行外部进程</h3><!-- The previous section described how easy it was to deal with files, readers or streams in Groovy. However in domains like system administration or devops it is often required to communicate with external processes. -->
<p>在上面的章节中我们看到了 Groovy 处理文件、<code>Reader</code> 和输入输出流有多简便。然而，在诸如系统管理或者 DevOps 这样的领域中，我们则需要 Groovy 脚本能够与外部进程进行通信。</p>
<!-- Groovy provides a simple way to execute command line processes. Simply write the command line as a string and call the execute() method. E.g., on a *nix machine (or a windows machine with appropriate *nix commands installed), you can execute this: -->
<p>Groovy 提供了一种十分简单的方法来执行命令行进程，只要把命令行写作一个简单的 <code>String</code> 对象然后调用其 <code>execute()</code> 方法即可。例如，在一个 *nix 机器上（或者一个安装了合适的 *nix 命令行环境的 Windows 机器上），你可以这样做：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> process = <span class="string">&quot;ls -l&quot;</span>.execute()             <span class="comment">// 注1</span></span><br><span class="line">println <span class="string">&quot;Found text $&#123;process.text&#125;&quot;</span>        <span class="comment">// 注2</span></span><br></pre></td></tr></table></figure>

<table>
    <colgroup>
        <col style="width: 5%">
        <col style="width: 95%">
    </colgroup>
    <tr>
        <td>1</td>
        <td>在一个外部进程中执行 `ls` 命令</td>
    </tr>
    <tr>
        <td>2</td>
        <td>消耗命令的输出并将其作为文本进行读取</td>
    </tr>
</table>

<!-- The execute() method returns a java.lang.Process instance which will subsequently allow the in/out/err streams to be processed and the exit value from the process to be inspected etc. -->
<p><code>execute()</code> 方法会返回一个 <code>java.lang.Process</code> 对象，借由此我们可以对标准输入/标准输出/错误输出流进行处理，或者检查进程退出时的退出值。</p>
<!-- e.g. here is the same command as above but we will now process the resulting stream a line at a time: -->
<p>例如，这里我们执行与上例相同的命令，但我们将逐行地处理其输出流：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> process = <span class="string">&quot;ls -l&quot;</span>.execute()             <span class="comment">// 注1</span></span><br><span class="line">process.<span class="keyword">in</span>.eachLine &#123; line -&gt;               <span class="comment">// 注2</span></span><br><span class="line">    println line                            <span class="comment">// 注3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
    <colgroup>
        <col style="width: 5%">
        <col style="width: 95%">
    </colgroup>
    <tr>
        <td>1</td>
        <td>在一个外部进程中执行 `ls` 命令</td>
    </tr>
    <tr>
        <td>2</td>
        <td>对于该进程的输入流中的每一行内容</td>
    </tr>
    <tr>
        <td>3</td>
        <td>输出该内容</td>
    </tr>
</table>

<!-- It is worth noting that in corresponds to an input stream to the standard output of the command. out will refer to a stream where you can send data to the process (its standard input). -->
<p>值得注意的是 <code>in</code> 代表的输入流对应着命令的标准输出，而你可以通过 <code>out</code> 代表的输出流向进程的标准输入写入数据。</p>
<!-- Remember that many commands are shell built-ins and need special handling. So if you want a listing of files in a directory on a Windows machine and write: -->
<p>注意，有不少命令实际上是 Shell 的内置功能，需要一些特殊的处理。所以如果你想要在一个 Windows 机器上列出一个文件夹内的所有文件，然后这样写的话：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> process = <span class="string">&quot;dir&quot;</span>.execute()</span><br><span class="line">println <span class="string">&quot;$&#123;process.text&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<!-- you will receive an IOException saying  Cannot run program "dir": CreateProcess error=2, The system cannot find the file specified. -->
<p>你会得到一个 <code>IOException</code>，内容如下：<code>Cannot run program &quot;dir&quot;: CreateProcess error=2, The system cannot find the file specified.</code></p>
<!-- This is because dir is built-in to the Windows shell (cmd.exe) and can’t be run as a simple executable. Instead, you will need to write: -->
<p>这是因为 <code>dir</code> 实际上是 Windows Shell（<code>cmd.exe</code>）的一个内置功能，不能被当做一个单纯的可执行文件来运行。因此，你应该这样写：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> process = <span class="string">&quot;cmd /c dir&quot;</span>.execute()</span><br><span class="line">println <span class="string">&quot;$&#123;process.text&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<!-- Also, because this functionality currently makes use of java.lang.Process undercover, the deficiencies of that class must be taken into consideration. In particular, the javadoc for this class says: -->
<p>除此之外，由于这个功能实际上是通过 <code>java.lang.Process</code> 实现的，因此我们也应该考虑到这个类的一些不足之处。具体来说，它的 JavaDoc 是这么说的：</p>
<!-- Because some native platforms only provide limited buffer size for standard input and output streams, failure to promptly write the input stream or read the output stream of the subprocess may cause the subprocess to block, and even deadlock -->

<blockquote>
<p>因为有些平台只为标准输入和输出流提供了很有限的缓存空间，写入输入流和读取输出流发生错误时可能会导致子进程发生阻塞，甚至发生死锁。</p>
</blockquote>
<!-- Because of this, Groovy provides some additional helper methods which make stream handling for processes easier. -->
<p>正是因为这个原因，Groovy 提供了一些额外的便捷方法来更好地处理外部进程的输入输出流。</p>
<!-- Here is how to gobble all of the output (including the error stream output) from your process: -->
<p>通过如下代码你可以消耗掉进程的所有输出（包括错误流输出）：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> p = <span class="string">&quot;rm -f foo.tmp&quot;</span>.execute([], tmpDir)</span><br><span class="line">p.consumeProcessOutput()</span><br><span class="line">p.waitFor()</span><br></pre></td></tr></table></figure>

<!-- There are also variations of consumeProcessOutput that make use of StringBuffer, InputStream, OutputStream etc…​ For a complete list, please read the GDK API for java.lang.Process -->
<p><code>consumeProcessOutput</code> 方法还包括其他一些变体可以利用 <code>StringBuffer</code>、<code>InputStream</code>、<code>OutputStream</code> 等，详见 <code>java.lang.Process</code> 的 <a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/lang/Process.html">GDK API</a>。</p>
<!-- In addition, these is a pipeTo command (mapped to | to allow overloading) which lets the output stream of one process be fed into the input stream of another process. -->
<p>除此之外，还有一个 <code>pipeTo</code> 方法（对应于 <code>|</code> 操作符且可进行重载）可以将一个进程的输出流内容转移到另一个进程的输入流中。</p>
<p>如下为使用该方法的案例。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">proc1 = <span class="string">&#x27;ls&#x27;</span>.execute()</span><br><span class="line">proc2 = <span class="string">&#x27;tr -d o&#x27;</span>.execute()</span><br><span class="line">proc3 = <span class="string">&#x27;tr -d e&#x27;</span>.execute()</span><br><span class="line">proc4 = <span class="string">&#x27;tr -d i&#x27;</span>.execute()</span><br><span class="line">proc1 | proc2 | proc3 | proc4</span><br><span class="line">proc4.waitFor()</span><br><span class="line"><span class="keyword">if</span> (proc4.exitValue()) &#123;</span><br><span class="line">    println proc4.err.text</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    println proc4.text</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>消耗错误流输出：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> sout = <span class="keyword">new</span> StringBuilder()</span><br><span class="line"><span class="keyword">def</span> serr = <span class="keyword">new</span> StringBuilder()</span><br><span class="line">proc2 = <span class="string">&#x27;tr -d o&#x27;</span>.execute()</span><br><span class="line">proc3 = <span class="string">&#x27;tr -d e&#x27;</span>.execute()</span><br><span class="line">proc4 = <span class="string">&#x27;tr -d i&#x27;</span>.execute()</span><br><span class="line">proc4.consumeProcessOutput(sout, serr)</span><br><span class="line">proc2 | proc3 | proc4</span><br><span class="line">[proc2, proc3].each &#123; it.consumeProcessErrorStream(serr) &#125;</span><br><span class="line">proc2.withWriter &#123; writer -&gt;</span><br><span class="line">    writer &lt;&lt; <span class="string">&#x27;testfile.groovy&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">proc4.waitForOrKill(<span class="number">1000</span>)</span><br><span class="line">println <span class="string">&quot;Standard output: $sout&quot;</span></span><br><span class="line">println <span class="string">&quot;Standard error: $serr&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-集合"><a href="#2-集合" class="headerlink" title="2 集合"></a>2 集合</h2><!-- Groovy provides native support for various collection types, including lists, maps or ranges. Most of those are based on the Java collection types and decorated with additional methods found in the Groovy development kit. -->
<p>Groovy 为各种不同的集合类型提供了原生的语言支持，包括<a target="_blank" rel="noopener" href="http://www.groovy-lang.org/groovy-dev-kit.html#Collections-Lists">列表</a>、<a target="_blank" rel="noopener" href="http://www.groovy-lang.org/groovy-dev-kit.html#Collections-Maps">映射</a>和<a target="_blank" rel="noopener" href="http://www.groovy-lang.org/groovy-dev-kit.html#Collections-Ranges">范围</a>。这些集合类大多数都基于 Java 原本的集合类型，同时加上了 <a target="_blank" rel="noopener" href="http://www.groovy-lang.org/gdk.html">GDK</a> 特有的方法。</p>
<h3 id="2-1-列表"><a href="#2-1-列表" class="headerlink" title="2.1 列表"></a>2.1 列表</h3><h4 id="2-1-1-列表字面量"><a href="#2-1-1-列表字面量" class="headerlink" title="2.1.1 列表字面量"></a>2.1.1 列表字面量</h4><!-- You can create lists as follows. Notice that [] is the empty list expression. -->
<p>你可以像如下代码那样创建列表。注意 <code>[]</code> 是空列表表达式。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line"><span class="keyword">assert</span> list.get(<span class="number">2</span>) == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> list[<span class="number">2</span>] == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> list <span class="keyword">instanceof</span> java.util.List</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> emptyList = []</span><br><span class="line"><span class="keyword">assert</span> emptyList.size() == <span class="number">0</span></span><br><span class="line">emptyList.add(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">assert</span> emptyList.size() == <span class="number">1</span></span><br></pre></td></tr></table></figure>

<!-- Each list expression creates an implementation of java.util.List. -->
<p>每一个列表表达式都会创建一个 <a target="_blank" rel="noopener" href="http://docs.oracle.com/javase/8/docs/api/java/util/List.html"><code>java.util.List</code></a> 实现类。</p>
<!-- Of course lists can be used as a source to construct another list: -->
<p>当然，列表也可以用于创建另一个列表：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list1 = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="comment">// 创建一个包含 `list1` 元素的新列表</span></span><br><span class="line"><span class="keyword">def</span> list2 = <span class="keyword">new</span> ArrayList&lt;String&gt;(list1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> list2 == list1 <span class="comment">// == checks that each corresponding element is the same</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// clone() can also be called</span></span><br><span class="line"><span class="keyword">def</span> list3 = list1.clone()</span><br><span class="line"><span class="keyword">assert</span> list3 == list1</span><br></pre></td></tr></table></figure>

<p>列表实际上就是对象的有序集合：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line"><span class="keyword">assert</span> list.size() == <span class="number">4</span></span><br><span class="line"><span class="keyword">assert</span> list.getClass() == ArrayList     <span class="comment">// 具体使用的列表实现类</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> list[<span class="number">2</span>] == <span class="number">7</span>                     <span class="comment">// 元素索引值从 0 开始</span></span><br><span class="line"><span class="keyword">assert</span> list.getAt(<span class="number">2</span>) == <span class="number">7</span>               <span class="comment">// 下标运算符 [] 的等价方法</span></span><br><span class="line"><span class="keyword">assert</span> list.get(<span class="number">2</span>) == <span class="number">7</span>                 <span class="comment">// 另一个可用的方法</span></span><br><span class="line"></span><br><span class="line">list[<span class="number">2</span>] = <span class="number">9</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>,]            <span class="comment">// 在尾部再加一个逗号也是可以的</span></span><br><span class="line"></span><br><span class="line">list.putAt(<span class="number">2</span>, <span class="number">10</span>)                       <span class="comment">// 使用 [] 修改元素值的等价方法</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">5</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">8</span>]</span><br><span class="line"><span class="keyword">assert</span> list.set(<span class="number">2</span>, <span class="number">11</span>) == <span class="number">10</span>            <span class="comment">// 可用的另一个修改元素的方法，返回旧的元素值</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">2.5</span>, <span class="number">2.5</span>f, <span class="number">2.5</span>d, <span class="string">&#x27;hello&#x27;</span>, <span class="number">7</span>g, <span class="literal">null</span>, <span class="number">9</span> <span class="keyword">as</span> <span class="keyword">byte</span>]</span><br><span class="line"><span class="comment">// 可以包含重复或不同类型的元素</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>][<span class="number">-1</span>] == <span class="number">5</span>             <span class="comment">// 使用负索引值从列表末尾开始访问元素</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>][<span class="number">-2</span>] == <span class="number">4</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].getAt(<span class="number">-2</span>) == <span class="number">4</span>       <span class="comment">// getAt() 同样接受负索引值</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].get(<span class="number">-2</span>)                 <span class="comment">// 但 get() 不接受负索引值</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="literal">false</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">assert</span> e <span class="keyword">instanceof</span> ArrayIndexOutOfBoundsException</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-将列表作为布尔表达式"><a href="#2-1-2-将列表作为布尔表达式" class="headerlink" title="2.1.2 将列表作为布尔表达式"></a>2.1.2 将列表作为布尔表达式</h4><p>列表可以被估作一个 <code>boolean</code> 值：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> ![]             <span class="comment">// 空白列表会被视作 `false` 值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 其他所有列表，无论其内容，都会被视作 `true`</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>] &amp;&amp; [<span class="string">&#x27;a&#x27;</span>] &amp;&amp; [<span class="number">0</span>] &amp;&amp; [<span class="number">0.0</span>] &amp;&amp; [<span class="literal">false</span>] &amp;&amp; [<span class="literal">null</span>]</span><br></pre></td></tr></table></figure>

<h4 id="2-1-3-遍历列表"><a href="#2-1-3-遍历列表" class="headerlink" title="2.1.3 遍历列表"></a>2.1.3 遍历列表</h4><p>通常我们可以通过调用 <code>each</code> 或 <code>eachWithIndex</code> 方法来遍历列表的所有元素并给定处理元素的代码：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].each &#123;</span><br><span class="line">    println <span class="string">&quot;Item: $it&quot;</span> <span class="comment">// `it` 是一个隐式参数，指代元素的索引值</span></span><br><span class="line">&#125;</span><br><span class="line">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>].eachWithIndex &#123; it, i -&gt; <span class="comment">// `it` 为当前元素，而 `i` 为当前索引值</span></span><br><span class="line">    println <span class="string">&quot;$i: $it&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>除了遍历列表，有时我们还需要对一个列表的元素进行转换进而构建出另一个新的列表。这个操作，又被称为映射，在 Groovy 中可通过 <code>collect</code> 方法完成：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].collect &#123; it * <span class="number">2</span> &#125; == [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// `collect` 的另一种快捷写法</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]*.multiply(<span class="number">2</span>) == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].collect &#123; it.multiply(<span class="number">2</span>) &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="number">0</span>]</span><br><span class="line"><span class="comment">// 可以通过给 `collect` 方法给定的列表放入新产生的元素</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].collect(list) &#123; it * <span class="number">2</span> &#125; == [<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br></pre></td></tr></table></figure>

<h4 id="2-1-4-过滤和查找"><a href="#2-1-4-过滤和查找" class="headerlink" title="2.1.4 过滤和查找"></a>2.1.4 过滤和查找</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].find &#123; it &gt; <span class="number">1</span> &#125; == <span class="number">2</span>               <span class="comment">// 查找第一个匹配给定条件的元素</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].findAll &#123; it &gt; <span class="number">1</span> &#125; == [<span class="number">2</span>, <span class="number">3</span>]       <span class="comment">// 查找所有匹配给定条件的元素</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>].findIndexOf &#123;      <span class="comment">// 查找第一个匹配给定条件的元素的索引值</span></span><br><span class="line">    it <span class="keyword">in</span> [<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]</span><br><span class="line">&#125; == <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;c&#x27;</span>].indexOf(<span class="string">&#x27;c&#x27;</span>) == <span class="number">2</span>  <span class="comment">// 返回索引值</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;c&#x27;</span>].indexOf(<span class="string">&#x27;z&#x27;</span>) == <span class="number">-1</span> <span class="comment">// 返回的索引值为 -1 意味着元素未找到</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;c&#x27;</span>].lastIndexOf(<span class="string">&#x27;c&#x27;</span>) == <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].every &#123; it &lt; <span class="number">5</span> &#125;                <span class="comment">// 如果所有元素都满足给定的条件则返回 true</span></span><br><span class="line"><span class="keyword">assert</span> ![<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].every &#123; it &lt; <span class="number">3</span> &#125;</span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].any &#123; it &gt; <span class="number">2</span> &#125;                     <span class="comment">// 如果存在满足给定条件的元素则返回 true</span></span><br><span class="line"><span class="keyword">assert</span> ![<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].any &#123; it &gt; <span class="number">3</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>].sum() == <span class="number">21</span>                <span class="comment">// 使用元素的 plus() 方法来返回元素的总和值</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>].sum &#123;</span><br><span class="line">    it == <span class="string">&#x27;a&#x27;</span> ? <span class="number">1</span> : it == <span class="string">&#x27;b&#x27;</span> ? <span class="number">2</span> : it == <span class="string">&#x27;c&#x27;</span> ? <span class="number">3</span> : it == <span class="string">&#x27;d&#x27;</span> ? <span class="number">4</span> : it == <span class="string">&#x27;e&#x27;</span> ? <span class="number">5</span> : <span class="number">0</span></span><br><span class="line">    <span class="comment">// 使用自定义的值来求和</span></span><br><span class="line">&#125; == <span class="number">15</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>].sum &#123; ((<span class="keyword">char</span>) it) - ((<span class="keyword">char</span>) <span class="string">&#x27;a&#x27;</span>) &#125; == <span class="number">10</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>].sum() == <span class="string">&#x27;abcde&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> [[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>], [<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]].sum() == [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以提供一个给定的初始值</span></span><br><span class="line"><span class="keyword">assert</span> [].sum(<span class="number">1000</span>) == <span class="number">1000</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].sum(<span class="number">1000</span>) == <span class="number">1006</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].join(<span class="string">&#x27;-&#x27;</span>) == <span class="string">&#x27;1-2-3&#x27;</span>           <span class="comment">// 字符串拼接</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].inject(<span class="string">&#x27;counting: &#x27;</span>) &#123;</span><br><span class="line">    str, item -&gt; str + item                     <span class="comment">// 归约操作</span></span><br><span class="line">&#125; == <span class="string">&#x27;counting: 123&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].inject(<span class="number">0</span>) &#123; count, item -&gt;</span><br><span class="line">    count + item</span><br><span class="line">&#125; == <span class="number">6</span></span><br></pre></td></tr></table></figure>

<p>Groovy 还提供了在集合中查找最大值和最小值的方法：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = [<span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">assert</span> list.max() == <span class="number">10</span></span><br><span class="line"><span class="keyword">assert</span> list.min() == <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 我们还可以比较包括字符在内的可比较的对象</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;z&#x27;</span>].min() == <span class="string">&#x27;a&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 我们还可以通过闭包来给定排序的行为</span></span><br><span class="line"><span class="keyword">def</span> list2 = [<span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;xyzuvw&#x27;</span>, <span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;321&#x27;</span>]</span><br><span class="line"><span class="keyword">assert</span> list2.max &#123; it.size() &#125; == <span class="string">&#x27;xyzuvw&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> list2.min &#123; it.size() &#125; == <span class="string">&#x27;z&#x27;</span></span><br></pre></td></tr></table></figure>

<p>除了闭包，你还可以使用 <code>Comparator</code> 来定义大小比较规则：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Comparator mc = &#123; a, b -&gt; a == b ? <span class="number">0</span> : (a &lt; b ? <span class="number">-1</span> : <span class="number">1</span>) &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">-6</span>, <span class="number">-1</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">-9</span>, <span class="number">5</span>, <span class="number">-13</span>]</span><br><span class="line"><span class="keyword">assert</span> list.max(mc) == <span class="number">11</span></span><br><span class="line"><span class="keyword">assert</span> list.min(mc) == <span class="number">-13</span></span><br><span class="line"></span><br><span class="line">Comparator mc2 = &#123; a, b -&gt; a == b ? <span class="number">0</span> : (Math.abs(a) &lt; Math.abs(b)) ? <span class="number">-1</span> : <span class="number">1</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> list.max(mc2) == <span class="number">-13</span></span><br><span class="line"><span class="keyword">assert</span> list.min(mc2) == <span class="number">-1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> list.max &#123; a, b -&gt; a.equals(b) ? <span class="number">0</span> : Math.abs(a) &lt; Math.abs(b) ? <span class="number">-1</span> : <span class="number">1</span> &#125; == <span class="number">-13</span></span><br><span class="line"><span class="keyword">assert</span> list.min &#123; a, b -&gt; a.equals(b) ? <span class="number">0</span> : Math.abs(a) &lt; Math.abs(b) ? <span class="number">-1</span> : <span class="number">1</span> &#125; == <span class="number">-1</span></span><br></pre></td></tr></table></figure>

<h4 id="2-1-5-添加和移除元素"><a href="#2-1-5-添加和移除元素" class="headerlink" title="2.1.5 添加和移除元素"></a>2.1.5 添加和移除元素</h4><p>我们可以使用 <code>[]</code> 来创建一个新的空列表并用 <code>&lt;&lt;</code> 来向其中追加元素：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = []</span><br><span class="line"><span class="keyword">assert</span> list.empty</span><br><span class="line"></span><br><span class="line">list &lt;&lt; <span class="number">5</span></span><br><span class="line"><span class="keyword">assert</span> list.size() == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">list &lt;&lt; <span class="number">7</span> &lt;&lt; <span class="string">&#x27;i&#x27;</span> &lt;&lt; <span class="number">11</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">5</span>, <span class="number">7</span>, <span class="string">&#x27;i&#x27;</span>, <span class="number">11</span>]</span><br><span class="line"></span><br><span class="line">list &lt;&lt; [<span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;o&#x27;</span>]</span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">5</span>, <span class="number">7</span>, <span class="string">&#x27;i&#x27;</span>, <span class="number">11</span>, [<span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;o&#x27;</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment">// &lt;&lt; 调用链的第一个对象为目标列表</span></span><br><span class="line"><span class="keyword">assert</span> ([<span class="number">1</span>, <span class="number">2</span>] &lt;&lt; <span class="number">3</span> &lt;&lt; [<span class="number">4</span>, <span class="number">5</span>] &lt;&lt; <span class="number">6</span>) == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>], <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 leftShift 方法等价于使用 &lt;&lt; 方法</span></span><br><span class="line"><span class="keyword">assert</span> ([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] &lt;&lt; <span class="number">4</span>) == ([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].leftShift(<span class="number">4</span>))</span><br></pre></td></tr></table></figure>

<p>除此之外很有很多种向列表中添加元素的方式：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>] + <span class="number">3</span> + [<span class="number">4</span>, <span class="number">5</span>] + <span class="number">6</span> == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="comment">// 等价于调用 `plus` 方法</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>].plus(<span class="number">3</span>).plus([<span class="number">4</span>, <span class="number">5</span>]).plus(<span class="number">6</span>) == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">a += <span class="number">4</span>      <span class="comment">// 创建一个新的列表并赋值给 `a`</span></span><br><span class="line">a += [<span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="keyword">assert</span> a == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, *[<span class="number">222</span>, <span class="number">333</span>], <span class="number">456</span>] == [<span class="number">1</span>, <span class="number">222</span>, <span class="number">333</span>, <span class="number">456</span>]</span><br><span class="line"><span class="keyword">assert</span> [*[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]] == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>], <span class="number">6</span>], <span class="number">7</span>, [<span class="number">8</span>, <span class="number">9</span>]].flatten() == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">list.add(<span class="number">3</span>)</span><br><span class="line">list.addAll([<span class="number">5</span>, <span class="number">4</span>])</span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">list = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">list.add(<span class="number">1</span>, <span class="number">3</span>) <span class="comment">// 在索引值 1 之前添加元素 3</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">list.addAll(<span class="number">2</span>, [<span class="number">5</span>, <span class="number">4</span>]) <span class="comment">// 在索引值 2 之前添加元素 5 和 4</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">list = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;g&#x27;</span>]</span><br><span class="line">list[<span class="number">8</span>] = <span class="string">&#x27;x&#x27;</span> <span class="comment">// [] 操作符在有需要的时候会扩充列表</span></span><br><span class="line"><span class="comment">// 并在需要的位置插入 null 值</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="literal">null</span>, <span class="string">&#x27;x&#x27;</span>]</span><br></pre></td></tr></table></figure>

<!-- It is however important that the + operator on a list is not mutating. Compared to <<, it will create a new list, which is often not what you want and can lead to performance issues. -->
<p>然而，值得注意的是，对列表使用 <code>+</code> 运算符并不会改变原列表。比起 <code>&lt;&lt;</code>，它会产生出一个新的列表，很多时候这可能不是你想要的效果进而带来一些性能上的问题。</p>
<!-- The Groovy development kit also contains methods allowing you to easily remove elements from a list by value: -->
<p>GDK 同样包含一些可以让你很方便地从列表中移除元素的方法：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>] - <span class="string">&#x27;c&#x27;</span> == [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>] - <span class="string">&#x27;b&#x27;</span> == [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>] - [<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>] == [<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line">list -= <span class="number">3</span>           <span class="comment">// 通过从原本的列表中移除 `3` 来创建一个新的列表</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> ( list -= [<span class="number">2</span>,<span class="number">4</span>] ) == [<span class="number">1</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<!-- It is also possible to remove an element by referring to its index, in which case the list is mutated: -->
<p>同样，我们还可以通过给定元素的索引值来移除元素，而这种情况则会改变原本的列表：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> list.removeAt(<span class="number">2</span>) == <span class="number">3</span>          <span class="comment">// 移除第三个元素并返回</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<!-- In case you only want to remove the first element having the same value in a list, instead of removing all elements, you call call the remove method: -->

<p>如果你只是想移除列表中第一个拥有给定值的元素而不是移除所有元素，你可以使用 <code>remove</code> 方法：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list= [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"><span class="keyword">assert</span> list.remove(<span class="string">&#x27;c&#x27;</span>)             <span class="comment">// 移除 &#x27;c&#x27;。由于成功找到元素并移除，因此返回 `true`</span></span><br><span class="line"><span class="keyword">assert</span> list.remove(<span class="string">&#x27;b&#x27;</span>)             <span class="comment">// 移除第一个 &#x27;b&#x27;，返回 `true`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> ! list.remove(<span class="string">&#x27;z&#x27;</span>)           <span class="comment">// 由于找不到元素 &#x27;z&#x27;，返回 `false`</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>]</span><br></pre></td></tr></table></figure>

<!-- And removing all the elements in a list can be done by calling the clear method: -->
<p>通过 <code>clear</code> 方法可以移除列表中的所有元素：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list= [<span class="string">&#x27;a&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;c&#x27;</span>,<span class="number">4</span>]</span><br><span class="line">list.clear()</span><br><span class="line"><span class="keyword">assert</span> list == []</span><br></pre></td></tr></table></figure>

<h4 id="2-1-6-集合操作"><a href="#2-1-6-集合操作" class="headerlink" title="2.1.6 集合操作"></a>2.1.6 集合操作</h4><p>GDK 还提供了可以更好地进行集合操作的方法：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> <span class="string">&#x27;a&#x27;</span> <span class="keyword">in</span> [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]             <span class="comment">// 如果该列表包含给定的元素则返回 true</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>].contains(<span class="string">&#x27;a&#x27;</span>)      <span class="comment">// 等价于 Java 的 `contains` 方法</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>].containsAll([<span class="number">1</span>,<span class="number">4</span>])       <span class="comment">// `containsAll` 方法会检查列表是否包含所有给定的元素</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>].count(<span class="number">3</span>) == <span class="number">4</span>  <span class="comment">// 计算列表中拥有给定值的元素个数</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>].count &#123;</span><br><span class="line">    it%<span class="number">2</span>==<span class="number">0</span>                             <span class="comment">// 计算列表中满足给定条件的元素个数</span></span><br><span class="line">&#125; == <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">12</span>].intersect([<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">12</span>]) == [<span class="number">1</span>,<span class="number">6</span>,<span class="number">12</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].disjoint( [<span class="number">4</span>,<span class="number">6</span>,<span class="number">9</span>] )</span><br><span class="line"><span class="keyword">assert</span> ![<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].disjoint( [<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>] )</span><br></pre></td></tr></table></figure>

<h4 id="2-1-7-排序"><a href="#2-1-7-排序" class="headerlink" title="2.1.7 排序"></a>2.1.7 排序</h4><!-- Working with collections often implies sorting. Groovy offers a variety of options to sort lists, from using closures to comparators, as in the following examples: -->
<p>使用集合时通常需要对其进行排序。Groovy 同样提供了多种排序列表的方式，可以使用闭包或是提供 <code>Comparator</code>，正如如下例子所示：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="number">6</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>].sort() == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;xyzuvw&#x27;</span>, <span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;321&#x27;</span>]</span><br><span class="line"><span class="keyword">assert</span> list.sort &#123;</span><br><span class="line">    it.size()</span><br><span class="line">&#125; == [<span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;321&#x27;</span>, <span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;xyzuvw&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list2 = [<span class="number">7</span>, <span class="number">4</span>, <span class="number">-6</span>, <span class="number">-1</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">-9</span>, <span class="number">5</span>, <span class="number">-13</span>]</span><br><span class="line"><span class="keyword">assert</span> list2.sort &#123; a, b -&gt; a == b ? <span class="number">0</span> : Math.abs(a) &lt; Math.abs(b) ? <span class="number">-1</span> : <span class="number">1</span> &#125; ==</span><br><span class="line">        [<span class="number">-1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">-6</span>, <span class="number">7</span>, <span class="number">-9</span>, <span class="number">11</span>, <span class="number">-13</span>]</span><br><span class="line"></span><br><span class="line">Comparator mc = &#123; a, b -&gt; a == b ? <span class="number">0</span> : Math.abs(a) &lt; Math.abs(b) ? <span class="number">-1</span> : <span class="number">1</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 只可用于 JDK 8+</span></span><br><span class="line"><span class="comment">// list2.sort(mc)</span></span><br><span class="line"><span class="comment">// assert list2 == [-1, 2, 3, 4, 5, -6, 7, -9, 11, -13]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list3 = [<span class="number">6</span>, <span class="number">-3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">-7</span>, <span class="number">1</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">Collections.sort(list3)</span><br><span class="line"><span class="keyword">assert</span> list3 == [<span class="number">-7</span>, <span class="number">-3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">Collections.sort(list3, mc)</span><br><span class="line"><span class="keyword">assert</span> list3 == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">-3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">-7</span>, <span class="number">9</span>]</span><br></pre></td></tr></table></figure>

<h4 id="2-1-8-复制元素"><a href="#2-1-8-复制元素" class="headerlink" title="2.1.8 复制元素"></a>2.1.8 复制元素</h4><!-- The Groovy development kit also takes advantage of operator overloading to provide methods allowing duplication of elements of a list: -->
<p>GDK 还利用了运算符重载的功能为列表提供了复制元素的方法：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] * <span class="number">3</span> == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].multiply(<span class="number">2</span>) == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">assert</span> Collections.nCopies(<span class="number">3</span>, <span class="string">&#x27;b&#x27;</span>) == [<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// JDK 定义的 `nCopies` 则有着不同的语义</span></span><br><span class="line"><span class="keyword">assert</span> Collections.nCopies(<span class="number">2</span>, [<span class="number">1</span>, <span class="number">2</span>]) == [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>]] <span class="comment">// 不是 [1,2,1,2]</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-映射"><a href="#2-2-映射" class="headerlink" title="2.2 映射"></a>2.2 映射</h3><h4 id="2-2-1-映射字面量"><a href="#2-2-1-映射字面量" class="headerlink" title="2.2.1 映射字面量"></a>2.2.1 映射字面量</h4><!-- In Groovy, maps (also known as associative arrays) can be created using the map literal syntax: [:]: -->
<p>在 Groovy 中，映射（又被称为联合数组）可使用映射字面量语法 <code>[:]</code> 创建：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [<span class="attr">name:</span> <span class="string">&#x27;Gromit&#x27;</span>, <span class="attr">likes:</span> <span class="string">&#x27;cheese&#x27;</span>, <span class="attr">id:</span> <span class="number">1234</span>]</span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="string">&#x27;name&#x27;</span>) == <span class="string">&#x27;Gromit&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="string">&#x27;id&#x27;</span>) == <span class="number">1234</span></span><br><span class="line"><span class="keyword">assert</span> map[<span class="string">&#x27;name&#x27;</span>] == <span class="string">&#x27;Gromit&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> map[<span class="string">&#x27;id&#x27;</span>] == <span class="number">1234</span></span><br><span class="line"><span class="keyword">assert</span> map <span class="keyword">instanceof</span> java.util.Map</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> emptyMap = [:]</span><br><span class="line"><span class="keyword">assert</span> emptyMap.size() == <span class="number">0</span></span><br><span class="line">emptyMap.put(<span class="string">&quot;foo&quot;</span>, <span class="number">5</span>)</span><br><span class="line"><span class="keyword">assert</span> emptyMap.size() == <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> emptyMap.get(<span class="string">&quot;foo&quot;</span>) == <span class="number">5</span></span><br></pre></td></tr></table></figure>

<!-- Map keys are strings by default: [a:1] is equivalent to ['a':1]. This can be confusing if you define a variable named a and that you want the value of a to be the key in your map. If this is the case, then you must escape the key by adding parenthesis, like in the following example: -->
<p>映射的键默认为字符串：<code>[a:1]</code> 等价于 <code>[&#39;a&#39;:1]</code>。你有可能会没能意识到这种语句的含义，如果你定义了一个叫 <code>a</code> 的变量并且你想将它的值作为映射的键的话。如果你想要这样做的话，你应该像下面的例子那样为键加上括号来进行转义：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> a = <span class="string">&#x27;Bob&#x27;</span></span><br><span class="line"><span class="keyword">def</span> ages = [<span class="attr">a:</span> <span class="number">43</span>]</span><br><span class="line"><span class="keyword">assert</span> ages[<span class="string">&#x27;Bob&#x27;</span>] == <span class="literal">null</span> <span class="comment">// 无法找到 `Bob`</span></span><br><span class="line"><span class="keyword">assert</span> ages[<span class="string">&#x27;a&#x27;</span>] == <span class="number">43</span>     <span class="comment">// 因为 `a` 是一个字面量</span></span><br><span class="line"></span><br><span class="line">ages = [(a): <span class="number">43</span>]            <span class="comment">// 现在我们通过为 `a` 加上括号来进行转义</span></span><br><span class="line"><span class="keyword">assert</span> ages[<span class="string">&#x27;Bob&#x27;</span>] == <span class="number">43</span>   <span class="comment">// 这样我们就能找到关联的值了</span></span><br></pre></td></tr></table></figure>

<!-- In addition to map literals, it is possible, to get a new copy of a map, to clone it: -->
<p>除了映射字面量，你还可以获取一个映射的拷贝：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [</span><br><span class="line">        <span class="attr">simple :</span> <span class="number">123</span>,</span><br><span class="line">        <span class="symbol">complex:</span> [<span class="attr">a:</span> <span class="number">1</span>, <span class="attr">b:</span> <span class="number">2</span>]</span><br><span class="line">]</span><br><span class="line"><span class="keyword">def</span> map2 = map.clone()</span><br><span class="line"><span class="keyword">assert</span> map2.get(<span class="string">&#x27;simple&#x27;</span>) == map.get(<span class="string">&#x27;simple&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> map2.get(<span class="string">&#x27;complex&#x27;</span>) == map.get(<span class="string">&#x27;complex&#x27;</span>)</span><br><span class="line">map2.get(<span class="string">&#x27;complex&#x27;</span>).put(<span class="string">&#x27;c&#x27;</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="string">&#x27;complex&#x27;</span>).get(<span class="string">&#x27;c&#x27;</span>) == <span class="number">3</span></span><br></pre></td></tr></table></figure>

<!-- The resulting map is a shallow copy of the original one, as illustrated in the previous example. -->
<p>正如上面的例子所示，所得的映射只是原映射的<strong>浅</strong>拷贝。</p>
<h4 id="2-2-2-映射属性访问语句"><a href="#2-2-2-映射属性访问语句" class="headerlink" title="2.2.2 映射属性访问语句"></a>2.2.2 映射属性访问语句</h4><!-- Maps also act like beans so you can use the property notation to get/set items inside the Map as long as the keys are strings which are valid Groovy identifiers: -->
<p>映射同样可以作为 Bean 使用，因此你也可以使用属性访问语句来访问映射，只要映射的键是字符串而且也是合法的 Groovy 标识符：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [<span class="attr">name:</span> <span class="string">&#x27;Gromit&#x27;</span>, <span class="attr">likes:</span> <span class="string">&#x27;cheese&#x27;</span>, <span class="attr">id:</span> <span class="number">1234</span>]</span><br><span class="line"><span class="keyword">assert</span> map.name == <span class="string">&#x27;Gromit&#x27;</span>     <span class="comment">// 可用于替换 map.get(&#x27;name&#x27;)</span></span><br><span class="line"><span class="keyword">assert</span> map.id == <span class="number">1234</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> emptyMap = [:]</span><br><span class="line"><span class="keyword">assert</span> emptyMap.size() == <span class="number">0</span></span><br><span class="line">emptyMap.foo = <span class="number">5</span></span><br><span class="line"><span class="keyword">assert</span> emptyMap.size() == <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> emptyMap.foo == <span class="number">5</span></span><br></pre></td></tr></table></figure>

<!-- Note: by design map.foo will always look for the key foo in the map. This means foo.class will return null on a map that doesn’t contain the class key. Should you really want to know the class, then you must use getClass(): -->
<p>注意，按这种规则的话，<code>map.foo</code> 会导致 Groovy 从映射 <code>map</code> 中查找 <code>foo</code>。这意味着如果映射 <code>map</code> 不包含键 <code>class</code> 的话，<code>map.class</code> 会返回 <code>null</code>。如果你只是想要获取映射的 <code>Class</code> 对象，你只能直接使用 <code>getClass()</code> 方法 ：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [<span class="attr">name:</span> <span class="string">&#x27;Gromit&#x27;</span>, <span class="attr">likes:</span> <span class="string">&#x27;cheese&#x27;</span>, <span class="attr">id:</span> <span class="number">1234</span>]</span><br><span class="line"><span class="keyword">assert</span> map.<span class="keyword">class</span> == <span class="literal">null</span></span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="string">&#x27;class&#x27;</span>) == <span class="literal">null</span></span><br><span class="line"><span class="keyword">assert</span> map.getClass() == LinkedHashMap <span class="comment">// 也许这才是你想要的</span></span><br><span class="line"></span><br><span class="line">map = [<span class="number">1</span>      : <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">       (<span class="literal">true</span>) : <span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">       (<span class="literal">false</span>): <span class="string">&#x27;q&#x27;</span>,</span><br><span class="line">       (<span class="literal">null</span>) : <span class="string">&#x27;x&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;null&#x27;</span> : <span class="string">&#x27;z&#x27;</span>]</span><br><span class="line"><span class="keyword">assert</span> map.containsKey(<span class="number">1</span>) <span class="comment">// `1` 并不是合法的标识符，所以只能这样写</span></span><br><span class="line"><span class="keyword">assert</span> map.<span class="literal">true</span> == <span class="literal">null</span></span><br><span class="line"><span class="keyword">assert</span> map.<span class="literal">false</span> == <span class="literal">null</span></span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="literal">true</span>) == <span class="string">&#x27;p&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="literal">false</span>) == <span class="string">&#x27;q&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> map.<span class="literal">null</span> == <span class="string">&#x27;z&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="literal">null</span>) == <span class="string">&#x27;x&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-3-遍历映射"><a href="#2-2-3-遍历映射" class="headerlink" title="2.2.3 遍历映射"></a>2.2.3 遍历映射</h4><p>正如之前那样，GDK 同样为映射提供了 <code>each</code> 和 <code>eachWithIndex</code> 方法来进行遍历。值得注意的是通过映射字面量表达式创建的映射是有序的，也就是说如果你尝试遍历映射，映射中的键值对将总是以其被添加到映射中的顺序被遍历。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [</span><br><span class="line">        <span class="attr">Bob  :</span> <span class="number">42</span>,</span><br><span class="line">        <span class="symbol">Alice:</span> <span class="number">54</span>,</span><br><span class="line">        <span class="attr">Max  :</span> <span class="number">33</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// `entry` 是映射中的一个键值对</span></span><br><span class="line">map.each &#123; entry -&gt;</span><br><span class="line">    println <span class="string">&quot;Name: $entry.key Age: $entry.value&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// `entry` 是映射中的一个键值对，`i` 则为其索引值</span></span><br><span class="line">map.eachWithIndex &#123; entry, i -&gt;</span><br><span class="line">    println <span class="string">&quot;$i - Name: $entry.key Age: $entry.value&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 除此之外，你也可以直接访问被遍历的键和值</span></span><br><span class="line">map.each &#123; key, value -&gt;</span><br><span class="line">    println <span class="string">&quot;Name: $key Age: $value&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 还能直接访问键、值以及索引值 `i`</span></span><br><span class="line">map.eachWithIndex &#123; key, value, i -&gt;</span><br><span class="line">    println <span class="string">&quot;$i - Name: $key Age: $value&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-4-添加和删除元素"><a href="#2-2-4-添加和删除元素" class="headerlink" title="2.2.4 添加和删除元素"></a>2.2.4 添加和删除元素</h4><!-- Adding an element to a map can be done either using the put method, the subscript operator or using putAll: -->
<p>可以通过 <code>put</code> 方法、<code>putAll</code> 方法或下标运算符来将一个元素添加到映射中：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> defaults = [<span class="number">1</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;b&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;c&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;d&#x27;</span>]</span><br><span class="line"><span class="keyword">def</span> overrides = [<span class="number">2</span>: <span class="string">&#x27;z&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;x&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;x&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> result = <span class="keyword">new</span> LinkedHashMap(defaults)</span><br><span class="line">result.put(<span class="number">15</span>, <span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">result[<span class="number">17</span>] = <span class="string">&#x27;u&#x27;</span></span><br><span class="line">result.putAll(overrides)</span><br><span class="line"><span class="keyword">assert</span> result == [<span class="number">1</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;z&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;c&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;d&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;x&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;x&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;t&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;u&#x27;</span>]</span><br></pre></td></tr></table></figure>

<!-- Removing all the elements of a map can be done by calling the clear method: -->
<p>调用 <code>clear</code> 方法可以移除映射中的所有元素：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> m = [<span class="number">1</span>:<span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>:<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"><span class="keyword">assert</span> m.get(<span class="number">1</span>) == <span class="string">&#x27;a&#x27;</span></span><br><span class="line">m.clear()</span><br><span class="line"><span class="keyword">assert</span> m == [:]</span><br></pre></td></tr></table></figure>

<!-- Maps generated using the map literal syntax are using the object equals and hashcode methods. This means that you should never use an object which hash code is subject to change over time, or you wouldn’t be able to get the associated value back. -->
<p>由映射字面量语法产生的映射依赖于键的 <code>equals</code> 和 <code>hashCode</code> 方法，因此你不应使用那些 <code>hashCode</code> 会发生变化的对象作为键，否则你很有可能无法获取到其关联的值。</p>
<!-- It is also worth noting that you should never use a GString as the key of a map, because the hash code of a GString is not the same as the hash code of an equivalent String: -->
<p>除此之外值得注意的是，你不应使用 <code>GString</code> 作为映射的键，因为 <code>GString</code> 的哈希码和内容与其相同的 <code>String</code> 的哈希码是不同的：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> key = <span class="string">&#x27;some key&#x27;</span></span><br><span class="line"><span class="keyword">def</span> map = [:]</span><br><span class="line"><span class="keyword">def</span> gstringKey = <span class="string">&quot;$&#123;key.toUpperCase()&#125;&quot;</span></span><br><span class="line">map.put(gstringKey,<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="string">&#x27;SOME KEY&#x27;</span>) == <span class="literal">null</span></span><br></pre></td></tr></table></figure>

<h4 id="2-1-5-键、值与键值对"><a href="#2-1-5-键、值与键值对" class="headerlink" title="2.1.5 键、值与键值对"></a>2.1.5 键、值与键值对</h4><!-- We can inspect the keys, values, and entries in a view: -->
<p>我们可以在一个视图中读取映射的键、值和键值对：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [<span class="number">1</span>:<span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>:<span class="string">&#x27;b&#x27;</span>, <span class="number">3</span>:<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> entries = map.entrySet()</span><br><span class="line">entries.each &#123; entry -&gt;</span><br><span class="line">  <span class="keyword">assert</span> entry.key <span class="keyword">in</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">  <span class="keyword">assert</span> entry.value <span class="keyword">in</span> [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> keys = map.keySet()</span><br><span class="line"><span class="keyword">assert</span> keys == [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>] <span class="keyword">as</span> Set</span><br></pre></td></tr></table></figure>

<!-- Mutating values returned by the view (be it a map entry, a key or a value) is highly discouraged because success of the operation directly depends on the type of the map being manipulated. In particular, Groovy relies on collections from the JDK that in general make no guarantee that a collection can safely be manipulated through keySet, entrySet, or values. -->
<p>通过该试图来修改映射（修改其键或值或键值对）都是不可取的，因为这样的操作是否能顺利执行直接取决于其背后被修改的映射的类型。具体来说，Groovy 所使用的来自 JDK 的集合类并不保证映射可以安全地通过其 <code>keySet</code>、<code>entrySet</code> 或 <code>values</code> 视图进行修改。</p>
<h4 id="2-1-6-过滤与查找"><a href="#2-1-6-过滤与查找" class="headerlink" title="2.1.6 过滤与查找"></a>2.1.6 过滤与查找</h4><!-- The Groovy development kit contains filtering, searching and collecting methods similar to those found for lists: -->
<p>GDK 也为映射提供了与<a target="_blank" rel="noopener" href="http://www.groovy-lang.org/groovy-dev-kit.html#List-Filtering">列表</a>类似的过滤、查找和收集方法：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> people = [</span><br><span class="line">    <span class="symbol">1:</span> [<span class="attr">name:</span><span class="string">&#x27;Bob&#x27;</span>, <span class="attr">age:</span> <span class="number">32</span>, <span class="attr">gender:</span> <span class="string">&#x27;M&#x27;</span>],</span><br><span class="line">    <span class="symbol">2:</span> [<span class="attr">name:</span><span class="string">&#x27;Johnny&#x27;</span>, <span class="attr">age:</span> <span class="number">36</span>, <span class="attr">gender:</span> <span class="string">&#x27;M&#x27;</span>],</span><br><span class="line">    <span class="symbol">3:</span> [<span class="attr">name:</span><span class="string">&#x27;Claire&#x27;</span>, <span class="attr">age:</span> <span class="number">21</span>, <span class="attr">gender:</span> <span class="string">&#x27;F&#x27;</span>],</span><br><span class="line">    <span class="symbol">4:</span> [<span class="attr">name:</span><span class="string">&#x27;Amy&#x27;</span>, <span class="attr">age:</span> <span class="number">54</span>, <span class="attr">gender:</span><span class="string">&#x27;F&#x27;</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> bob = people.find &#123; it.value.name == <span class="string">&#x27;Bob&#x27;</span> &#125; <span class="comment">// 查找单一键值对</span></span><br><span class="line"><span class="keyword">def</span> females = people.findAll &#123; it.value.gender == <span class="string">&#x27;F&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上述两个方法均返回键值对，但你可以使用 `collect` 方法来获取其域</span></span><br><span class="line"><span class="keyword">def</span> ageOfBob = bob.value.age</span><br><span class="line"><span class="keyword">def</span> agesOfFemales = females.collect &#123;</span><br><span class="line">    it.value.age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> ageOfBob == <span class="number">32</span></span><br><span class="line"><span class="keyword">assert</span> agesOfFemales == [<span class="number">21</span>,<span class="number">54</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你还可以使用键值对作为闭包的参数</span></span><br><span class="line"><span class="keyword">def</span> agesOfMales = people.findAll &#123; id, person -&gt;</span><br><span class="line">    person.gender == <span class="string">&#x27;M&#x27;</span></span><br><span class="line">&#125;.collect &#123; id, person -&gt;</span><br><span class="line">    person.age</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">assert</span> agesOfMales == [<span class="number">32</span>, <span class="number">36</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果所有键值对均满足给定的条件则 `every` 方法返回 true </span></span><br><span class="line"><span class="keyword">assert</span> people.every &#123; id, person -&gt;</span><br><span class="line">    person.age &gt; <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果存在键值对满足给定的条件则 `any` 方法返回 true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> people.any &#123; id, person -&gt;</span><br><span class="line">    person.age == <span class="number">54</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-7-分组"><a href="#2-1-7-分组" class="headerlink" title="2.1.7 分组"></a>2.1.7 分组</h4><!-- We can group a list into a map using some criteria: -->
<p>我们可以通过给定一个条件来让列表中的元素各自分组形成一个列表：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="string">&#x27;a&#x27;</span>, <span class="number">7</span>, <span class="string">&#x27;b&#x27;</span>, [<span class="number">2</span>, <span class="number">3</span>]].groupBy &#123;</span><br><span class="line">    it.<span class="keyword">class</span></span><br><span class="line">&#125; == [(String)   : [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>],</span><br><span class="line">      (Integer)  : [<span class="number">7</span>],</span><br><span class="line">      (ArrayList): [[<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [</span><br><span class="line">        [<span class="attr">name:</span> <span class="string">&#x27;Clark&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;London&#x27;</span>], [<span class="attr">name:</span> <span class="string">&#x27;Sharma&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;London&#x27;</span>],</span><br><span class="line">        [<span class="attr">name:</span> <span class="string">&#x27;Maradona&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;LA&#x27;</span>], [<span class="attr">name:</span> <span class="string">&#x27;Zhang&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;HK&#x27;</span>],</span><br><span class="line">        [<span class="attr">name:</span> <span class="string">&#x27;Ali&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;HK&#x27;</span>], [<span class="attr">name:</span> <span class="string">&#x27;Liu&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;HK&#x27;</span>],</span><br><span class="line">].groupBy &#123; it.city &#125; == [</span><br><span class="line">        <span class="symbol">London:</span> [[<span class="attr">name:</span> <span class="string">&#x27;Clark&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;London&#x27;</span>],</span><br><span class="line">                 [<span class="attr">name:</span> <span class="string">&#x27;Sharma&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;London&#x27;</span>]],</span><br><span class="line">        <span class="attr">LA    :</span> [[<span class="attr">name:</span> <span class="string">&#x27;Maradona&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;LA&#x27;</span>]],</span><br><span class="line">        <span class="attr">HK    :</span> [[<span class="attr">name:</span> <span class="string">&#x27;Zhang&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;HK&#x27;</span>],</span><br><span class="line">                 [<span class="attr">name:</span> <span class="string">&#x27;Ali&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;HK&#x27;</span>],</span><br><span class="line">                 [<span class="attr">name:</span> <span class="string">&#x27;Liu&#x27;</span>, <span class="attr">city:</span> <span class="string">&#x27;HK&#x27;</span>]],</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="2-3-区间"><a href="#2-3-区间" class="headerlink" title="2.3 区间"></a>2.3 区间</h3><!-- Ranges allow you to create a list of sequential values. These can be used as List since Range extends java.util.List. -->
<p>你可以使用区间（Range）来创建一个由连续值组成的列表。区间可以被直接用作 <code>List</code> 因为 <a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/api/groovy/lang/Range.html"><code>Range</code></a> 扩展了 <a target="_blank" rel="noopener" href="http://docs.oracle.com/javase/8/docs/api/java/util/List.html"><code>java.util.List</code></a>。</p>
<!-- Ranges defined with the .. notation are inclusive (that is the list contains the from and to value). -->
<p>使用 <code>..</code> 记号定义的区间是一个闭区间（也就是说该列表包含了起始值和终止值）。</p>
<!-- Ranges defined with the ..< notation are half-open, they include the first value but not the last value. -->
<p>使用 <code>..&lt;</code> 记号定义的区间则是一个半开区间：它包含起始值但不包含终止值。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 闭区间</span></span><br><span class="line"><span class="keyword">def</span> range = <span class="number">5.</span><span class="number">.8</span></span><br><span class="line"><span class="keyword">assert</span> range.size() == <span class="number">4</span></span><br><span class="line"><span class="keyword">assert</span> range.get(<span class="number">2</span>) == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> range[<span class="number">2</span>] == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> range <span class="keyword">instanceof</span> java.util.List</span><br><span class="line"><span class="keyword">assert</span> range.contains(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">assert</span> range.contains(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 半开区间</span></span><br><span class="line">range = <span class="number">5.</span>.&lt;<span class="number">8</span></span><br><span class="line"><span class="keyword">assert</span> range.size() == <span class="number">3</span></span><br><span class="line"><span class="keyword">assert</span> range.get(<span class="number">2</span>) == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> range[<span class="number">2</span>] == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> range <span class="keyword">instanceof</span> java.util.List</span><br><span class="line"><span class="keyword">assert</span> range.contains(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">assert</span> !range.contains(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以在不使用集体索引值的情况下获取区间的端点值</span></span><br><span class="line">range = <span class="number">1.</span><span class="number">.10</span></span><br><span class="line"><span class="keyword">assert</span> range.from == <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> range.to == <span class="number">10</span></span><br></pre></td></tr></table></figure>

<!-- Note that int ranges are implemented efficiently, creating a lightweight Java object containing a from and to value. -->
<p>值得注意的是，<code>int</code> 类型区间的实现方式十分高效，实际上就是一个只包含了起始值和终止值的 Java 对象。</p>
<!-- Ranges can be used for any Java object which implements java.lang.Comparable for comparison and also have methods next() and previous() to return the next / previous item in the range. For example, you can create a range of String elements: -->
<p>区间可以被用作任何实现了 <code>java.lang.Comparable</code> 接口用于进行大小比较，同时又有方法 <code>next()</code> 和 <code>previous()</code> 用于返回其上一个和下一个值的 Java 对象。例如，你可以创建一个由 <code>String</code> 元素组成的区间：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 闭区间</span></span><br><span class="line"><span class="keyword">def</span> range = <span class="string">&#x27;a&#x27;</span>..<span class="string">&#x27;d&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> range.size() == <span class="number">4</span></span><br><span class="line"><span class="keyword">assert</span> range.get(<span class="number">2</span>) == <span class="string">&#x27;c&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> range[<span class="number">2</span>] == <span class="string">&#x27;c&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> range <span class="keyword">instanceof</span> java.util.List</span><br><span class="line"><span class="keyword">assert</span> range.contains(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> range.contains(<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> !range.contains(<span class="string">&#x27;e&#x27;</span>)</span><br></pre></td></tr></table></figure>

<!-- You can iterate on a range using a classic for loop: -->
<p>你可以使用经典的 <code>for</code> 循环来迭代区间：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span>) &#123;</span><br><span class="line">    println <span class="string">&quot;Hello $&#123;i&#125;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<!-- but alternatively you can achieve the same effect in a more Groovy idiomatic style, by iterating a range with each method: -->
<p>但你也可以通过使用 <code>each</code> 方法来更 Groovy 地迭代区间：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1.</span><span class="number">.10</span>).each &#123; i -&gt;</span><br><span class="line">    println <span class="string">&quot;Hello $&#123;i&#125;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<!-- Ranges can be also used in the switch statement: -->
<p>区间还可用于 <code>switch</code> 语句：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (years) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1.</span><span class="number">.10</span>: interestRate = <span class="number">0.076</span>; <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">11.</span><span class="number">.25</span>: interestRate = <span class="number">0.052</span>; <span class="keyword">break</span>;</span><br><span class="line">    <span class="symbol">default:</span> interestRate = <span class="number">0.037</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-集合类的语法增强"><a href="#2-4-集合类的语法增强" class="headerlink" title="2.4 集合类的语法增强"></a>2.4 集合类的语法增强</h3><h4 id="2-4-1-GPath-支持"><a href="#2-4-1-GPath-支持" class="headerlink" title="2.4.1 GPath 支持"></a>2.4.1 GPath 支持</h4><p>多亏了列表和映射都支持属性访问语法，在 Groovy 中我们可以使用语法糖来更好地应对嵌套集合，如下例所示：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> listOfMaps = [[<span class="string">&#x27;a&#x27;</span>: <span class="number">11</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">12</span>], [<span class="string">&#x27;a&#x27;</span>: <span class="number">21</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">22</span>]]</span><br><span class="line"><span class="keyword">assert</span> listOfMaps.a == [<span class="number">11</span>, <span class="number">21</span>] <span class="comment">// GPath 语法</span></span><br><span class="line"><span class="keyword">assert</span> listOfMaps*.a == [<span class="number">11</span>, <span class="number">21</span>] <span class="comment">// 延伸点语法</span></span><br><span class="line"></span><br><span class="line">listOfMaps = [[<span class="string">&#x27;a&#x27;</span>: <span class="number">11</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">12</span>], [<span class="string">&#x27;a&#x27;</span>: <span class="number">21</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">22</span>], <span class="literal">null</span>]</span><br><span class="line"><span class="keyword">assert</span> listOfMaps*.a == [<span class="number">11</span>, <span class="number">21</span>, <span class="literal">null</span>] <span class="comment">// 可以很好地应对 null 值</span></span><br><span class="line"><span class="keyword">assert</span> listOfMaps*.a == listOfMaps.collect &#123; it?.a &#125; <span class="comment">// 判等语法</span></span><br><span class="line"><span class="comment">// 但这时候只会收集非 null 值</span></span><br><span class="line">assert listOfMaps.a == [<span class="number">11</span>,<span class="number">21</span>]</span><br></pre></td></tr></table></figure>

<h4 id="2-4-2-延伸运算符"><a href="#2-4-2-延伸运算符" class="headerlink" title="2.4.2 延伸运算符"></a>2.4.2 延伸运算符</h4><!-- The spread operator can be used to "inline" a collection into another. It is syntactic sugar which often avoids calls to putAll and facilitates the realization of one-liners: -->
<p>延伸运算符可用于将一个集合“内联”到另一个集合之中。这个语法糖主要为了使我们不需要调用 <code>putAll</code> 方法并能写出更简短的代码：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [ <span class="string">&#x27;z&#x27;</span>: <span class="number">900</span>,</span><br><span class="line">         *: [<span class="string">&#x27;a&#x27;</span>: <span class="number">100</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">200</span>], <span class="string">&#x27;a&#x27;</span>: <span class="number">300</span>] == [<span class="string">&#x27;a&#x27;</span>: <span class="number">300</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;z&#x27;</span>: <span class="number">900</span>]</span><br><span class="line"><span class="comment">// 用于映射定义的延伸映射语法</span></span><br><span class="line"><span class="keyword">assert</span> [*: [<span class="number">3</span>: <span class="number">3</span>, *: [<span class="number">5</span>: <span class="number">5</span>]], <span class="number">7</span>: <span class="number">7</span>] == [<span class="number">3</span>: <span class="number">3</span>, <span class="number">5</span>: <span class="number">5</span>, <span class="number">7</span>: <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> f = &#123; [<span class="number">1</span>: <span class="string">&#x27;u&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;v&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;w&#x27;</span>] &#125;</span><br><span class="line"><span class="keyword">assert</span> [*: f(), <span class="number">10</span>: <span class="string">&#x27;zz&#x27;</span>] == [<span class="number">1</span>: <span class="string">&#x27;u&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;zz&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;v&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;w&#x27;</span>]</span><br><span class="line"><span class="comment">// 用于方法实参的延伸映射语法</span></span><br><span class="line">f = &#123; map -&gt; map.c &#125;</span><br><span class="line"><span class="keyword">assert</span> f(*: [<span class="string">&#x27;a&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">20</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">30</span>], <span class="string">&#x27;e&#x27;</span>: <span class="number">50</span>) == <span class="number">30</span></span><br><span class="line"></span><br><span class="line">f = &#123; m, i, j, k -&gt; [m, i, j, k] &#125;</span><br><span class="line"><span class="comment">// 使用延伸映射语法给定方法的具名参数和不具名参数</span></span><br><span class="line"><span class="keyword">assert</span> f(<span class="string">&#x27;e&#x27;</span>: <span class="number">100</span>, *[<span class="number">4</span>, <span class="number">5</span>], *: [<span class="string">&#x27;a&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">20</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">30</span>], <span class="number">6</span>) ==</span><br><span class="line">        [[<span class="string">&quot;e&quot;</span>: <span class="number">100</span>, <span class="string">&quot;b&quot;</span>: <span class="number">20</span>, <span class="string">&quot;c&quot;</span>: <span class="number">30</span>, <span class="string">&quot;a&quot;</span>: <span class="number">10</span>], <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br></pre></td></tr></table></figure>

<h4 id="2-4-3-运算符"><a href="#2-4-3-运算符" class="headerlink" title="2.4.3 *. 运算符"></a>2.4.3 <code>*.</code> 运算符</h4><!-- The "star-dot" operator is a shortcut operator allowing you to call a method or a property on all elements of a collection: -->
<p>星点运算符可用于调用集合中所有元素的某个方法或属性：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>] == [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;few&#x27;</span>, <span class="string">&#x27;words&#x27;</span>]*.size()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span></span><br><span class="line">    String name</span><br><span class="line">    <span class="keyword">int</span> age</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">def</span> persons = [<span class="keyword">new</span> Person(<span class="attr">name:</span><span class="string">&#x27;Hugo&#x27;</span>, <span class="attr">age:</span><span class="number">17</span>), <span class="keyword">new</span> Person(<span class="attr">name:</span><span class="string">&#x27;Sandra&#x27;</span>,<span class="attr">age:</span><span class="number">19</span>)]</span><br><span class="line"><span class="keyword">assert</span> [<span class="number">17</span>, <span class="number">19</span>] == persons*.age</span><br></pre></td></tr></table></figure>

<h4 id="2-4-4-使用下标运算符进行分割"><a href="#2-4-4-使用下标运算符进行分割" class="headerlink" title="2.4.4 使用下标运算符进行分割"></a>2.4.4 使用下标运算符进行分割</h4><!-- You can index into lists, arrays, maps using the subscript expression. It is interesting that strings are considered as special kinds of collections in that context: -->
<p>你可以使用下标运算符根据索引值来访问列表、元素和映射的元素。有趣的是在这种情况下，字符串也会被视作特殊的集合：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> text = <span class="string">&#x27;nice cheese gromit!&#x27;</span></span><br><span class="line"><span class="keyword">def</span> x = text[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> x == <span class="string">&#x27;c&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> x.<span class="keyword">class</span> == String</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> sub = text[<span class="number">5.</span><span class="number">.10</span>]</span><br><span class="line"><span class="keyword">assert</span> sub == <span class="string">&#x27;cheese&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>]</span><br><span class="line"><span class="keyword">def</span> answer = list[<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">assert</span> answer == [<span class="number">12</span>,<span class="number">13</span>]</span><br></pre></td></tr></table></figure>

<p>值得注意的是你可以使用区间来获取集合中的一小部分：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">list = <span class="number">100.</span><span class="number">.200</span></span><br><span class="line">sub = list[<span class="number">1</span>, <span class="number">3</span>, <span class="number">20.</span><span class="number">.25</span>, <span class="number">33</span>]</span><br><span class="line"><span class="keyword">assert</span> sub == [<span class="number">101</span>, <span class="number">103</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">122</span>, <span class="number">123</span>, <span class="number">124</span>, <span class="number">125</span>, <span class="number">133</span>]</span><br></pre></td></tr></table></figure>

<p>对于那些可变的集合，下标运算符可用于更新集合的值：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">list = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;d&#x27;</span>]</span><br><span class="line">list[<span class="number">1.</span><span class="number">.2</span>] = [<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="keyword">assert</span> list == [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>除此之外，你还可以使用负索引值来更好地从集合末尾开始提取元素：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">text = <span class="string">&quot;nice cheese gromit!&quot;</span></span><br><span class="line">x = text[<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">assert</span> x == <span class="string">&quot;!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> name = text[<span class="number">-7.</span>.<span class="number">-2</span>]</span><br><span class="line"><span class="keyword">assert</span> name == <span class="string">&quot;gromit&quot;</span></span><br></pre></td></tr></table></figure>

<p>最后，如果你使用的是一个反向区间（起始值大于终止值），那么所得的结果也是反向的：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">text = <span class="string">&quot;nice cheese gromit!&quot;</span></span><br><span class="line">name = text[<span class="number">3.</span><span class="number">.1</span>]</span><br><span class="line"><span class="keyword">assert</span> name == <span class="string">&quot;eci&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-5-新添加的集合方法"><a href="#2-5-新添加的集合方法" class="headerlink" title="2.5 新添加的集合方法"></a>2.5 新添加的集合方法</h3><!-- In addition to lists, maps or ranges, Groovy offers a lot of additional methods for filtering, collecting, grouping, counting, …​ which are directly available on either collections or more easily iterables. -->
<p>除了<a target="_blank" rel="noopener" href="http://www.groovy-lang.org/groovy-dev-kit.html#Collections-Lists">列表</a>、<a target="_blank" rel="noopener" href="http://www.groovy-lang.org/groovy-dev-kit.html#Collections-Maps">映射</a>和<a target="_blank" rel="noopener" href="http://www.groovy-lang.org/groovy-dev-kit.html#Collections-Ranges">区间</a>以外，Groovy 还为其他集合或更普通的 <code>Iterable</code> 类提供了更多的用于过滤、收集、分组、计数等方法。</p>
<!-- In particular, we invite you to read the Groovy development kit API docs and specifically: -->
<p>有关这方面的内容，我们希望你能仔细阅读 <a target="_blank" rel="noopener" href="http://www.groovy-lang.org/gdk.html">GDK</a> 的 API 文档。具体来说：</p>
<ul>
<li>在<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/lang/Iterable.html">这里</a>可以找到 <code>Iterable</code> 的新方法</li>
<li>在<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Iterator.html">这里</a>可以找到 <code>Iterator</code> 的新方法</li>
<li>在<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Collection.html">这里</a>可以找到 <code>Collection</code> 的新方法</li>
<li>在<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/List.html">这里</a>可以找到 <code>List</code> 的新方法</li>
<li>在<a target="_blank" rel="noopener" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Map.html">这里</a>可以找到 <code>Map</code> 的新方法</li>
</ul>
<h2 id="3-其他好用的功能"><a href="#3-其他好用的功能" class="headerlink" title="3 其他好用的功能"></a>3 其他好用的功能</h2><h3 id="3-1-ConfigSlurper"><a href="#3-1-ConfigSlurper" class="headerlink" title="3.1 ConfigSlurper"></a>3.1 ConfigSlurper</h3><!-- ConfigSlurper is a utility class for reading configuration files defined in the form of Groovy scripts. Like it is the case with Java *.properties files, ConfigSlurper allows a dot notation. But in addition, it allows for Closure scoped configuration values and arbitrary object types. -->
<p><code>ConfigSlurper</code> 是可用于读取以 Groovy 脚本形式编写的配置文件的功能类。正如 Java 的 <code>*.properties</code> 文件那样，<code>ConfigSlurper</code> 也可以使用点号语法进行访问，除此之外它还能用闭包括号来给定配置值以及任意的对象类型：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> config = <span class="keyword">new</span> ConfigSlurper().parse(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    app.date = new Date()  // 注1</span></span><br><span class="line"><span class="string">    app.age  = 42</span></span><br><span class="line"><span class="string">    app &#123;                  // 注2</span></span><br><span class="line"><span class="string">        name = &quot;Test$&#123;42&#125;&quot;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> config.app.date <span class="keyword">instanceof</span> Date</span><br><span class="line"><span class="keyword">assert</span> config.app.age == <span class="number">42</span></span><br><span class="line"><span class="keyword">assert</span> config.app.name == <span class="string">&#x27;Test42&#x27;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>使用点号语法</li>
<li>使用闭包括号语法替代点号语法</li>
</ol>
<!-- As can be seen in the above example, the parse method can be used to retrieve groovy.util.ConfigObject instances. The ConfigObject is a specialized java.util.Map implementation that either returns the configured value or a new ConfigObject instance but never null. -->
<p>正如我们在上一个例子中所见到的那样，<code>parse</code> 方法可用于获取一个 <code>groovy.util.ConfigObject</code> 实例。<code>ConfigObject</code> 是一种特殊的 <code>java.util.Map</code> 实现类，它要么返回具体的配置值要么返回一个新的 <code>ConfigObject</code>，但绝不会返回 <code>null</code>。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> config = <span class="keyword">new</span> ConfigSlurper().parse(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    app.date = new Date()</span></span><br><span class="line"><span class="string">    app.age  = 42</span></span><br><span class="line"><span class="string">    app.name = &quot;Test$&#123;42&#125;&quot;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> config.test != <span class="literal">null</span>   <span class="comment">// 注1</span></span><br></pre></td></tr></table></figure>

<ol>
<li><pre><code>我们并未给出 `config.test`，但在被调用时仍然返回了一个 `ConfigObject`
</code></pre>
</li>
</ol>
<!-- In the case of a dot being part of a configuration variable name, it can be escaped by using single or double quotes. -->
<p>如果点号本身需要作为配置变量的名称的话，可以使用单引号或双引号对其进行转义：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> config = <span class="keyword">new</span> ConfigSlurper().parse(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    app.&quot;person.age&quot;  = 42</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> config.app.<span class="string">&quot;person.age&quot;</span> == <span class="number">42</span></span><br></pre></td></tr></table></figure>

<!-- In addition, ConfigSlurper comes with support for environments. The environments method can be used to hand over a Closure instance that itself may consist of a several sections. Let’s say we wanted to create a particular configuration value for the development environment. When creating the ConfigSlurper instance we can use the ConfigSlurper(String) constructor to specify the target environment. -->
<p>除此之外，<code>ConfigSlurper</code> 还支持不同的环境。<code>environments</code> 方法可被用于处理一个包含若干个配置小节的 <code>Closure</code> 实例。假设我们想要为开发环境创建一些特别的配置值。那么在创建 <code>ConfigSlurper</code> 实例时我们可以使用 <code>ConfigSlurper(String)</code> 构造器来给定目标环境：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> config = <span class="keyword">new</span> ConfigSlurper(<span class="string">&#x27;development&#x27;</span>).parse(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">  environments &#123;</span></span><br><span class="line"><span class="string">       development &#123;</span></span><br><span class="line"><span class="string">           app.port = 8080</span></span><br><span class="line"><span class="string">       &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       test &#123;</span></span><br><span class="line"><span class="string">           app.port = 8082</span></span><br><span class="line"><span class="string">       &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       production &#123;</span></span><br><span class="line"><span class="string">           app.port = 80</span></span><br><span class="line"><span class="string">       &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> config.app.port == <span class="number">8080</span></span><br></pre></td></tr></table></figure>

<!-- The ConfigSlurper environments aren’t restricted to any particular environment names. It solely depends on the ConfigSlurper client code what value are supported and interpreted accordingly. -->
<p><code>ConfigSlurper</code> 支持的环境并不只局限于几个具体的环境名，它取决于 <code>ConfigSlurper</code> 的客户端代码支持的环境并能基于此进行解析。</p>
<!-- The environments method is built-in but the registerConditionalBlock method can be used to register other method names in addition to the environments name. -->
<p><code>environments</code> 方法本身是内置的，但你同样可以通过 <code>registerConditionalBlock</code> 来注册除了 <code>environments</code> 以外的方法名：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> slurper = <span class="keyword">new</span> ConfigSlurper()</span><br><span class="line">slurper.registerConditionalBlock(<span class="string">&#x27;myProject&#x27;</span>, <span class="string">&#x27;developers&#x27;</span>)   <span class="comment">// 注1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> config = slurper.parse(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">  sendMail = true</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  myProject &#123;</span></span><br><span class="line"><span class="string">       developers &#123;</span></span><br><span class="line"><span class="string">           sendMail = false</span></span><br><span class="line"><span class="string">       &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> !config.sendMail</span><br></pre></td></tr></table></figure>

<ol>
<li>在注册了新的代码块以后，<code>ConfigSlurper</code> 就能进行解析了</li>
</ol>
<!-- For Java integration purposes the toProperties method can be used to convert the ConfigObject to a java.util.Properties object that might be stored to a *.properties text file. Be aware though that the configuration values are converted to String instances during adding them to the newly created Properties instance. -->
<p>在与 Java 进行整合时，我们可以使用 <code>toProperties</code> 方法将 <code>ConfigObject</code> 转换成一个 <code>java.util.Properties</code>，然后再将其存储至一个 <code>*.properties</code> 文本文件中。但要注意的是在转换成新的 <code>Properties</code> 实例的时候所有配置值都会被转换为 <code>String</code> 实例。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> config = <span class="keyword">new</span> ConfigSlurper().parse(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    app.date = new Date()</span></span><br><span class="line"><span class="string">    app.age  = 42</span></span><br><span class="line"><span class="string">    app &#123;</span></span><br><span class="line"><span class="string">        name = &quot;Test$&#123;42&#125;&quot;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> properties = config.toProperties()</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> properties.<span class="string">&quot;app.date&quot;</span> <span class="keyword">instanceof</span> String</span><br><span class="line"><span class="keyword">assert</span> properties.<span class="string">&quot;app.age&quot;</span> == <span class="string">&#x27;42&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> properties.<span class="string">&quot;app.name&quot;</span> == <span class="string">&#x27;Test42&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-Expando"><a href="#3-2-Expando" class="headerlink" title="3.2 Expando"></a>3.2 Expando</h3><!-- The Expando class can be used to create a dynamically expandable object. Despite its name it does not use the ExpandoMetaClass underneath. Each Expando object represents a standalone, dynamically-crafted instance that can be extended with properties (or methods) at runtime. -->
<p><code>Expando</code> 类可用于创建一个可动态扩展的对象。尽管它的名字看起来很像，但实际上它并没有利用 <code>ExpandoMetaClass</code> 来实现。每个 <code>Expando</code> 对象都代表一个独立的、可动态构造的实例，这些实例可在运行时用属性或方法进行扩展。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> expando = <span class="keyword">new</span> Expando()</span><br><span class="line">expando.name = <span class="string">&#x27;John&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> expando.name == <span class="string">&#x27;John&#x27;</span></span><br></pre></td></tr></table></figure>

<!-- A special case occurs when a dynamic property registers a Closure code block. Once being registered it can be invoked as it would be done with a method call. -->
<p>当将一个闭包代码块注册为动态属性时则比较特殊：在完成注册后可以像调用方法那样对其进行调用：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> expando = <span class="keyword">new</span> Expando()</span><br><span class="line">expando.toString = &#123; -&gt; <span class="string">&#x27;John&#x27;</span> &#125;</span><br><span class="line">expando.say = &#123; String s -&gt; <span class="string">&quot;John says: $&#123;s&#125;&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> expando <span class="keyword">as</span> String == <span class="string">&#x27;John&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> expando.say(<span class="string">&#x27;Hi&#x27;</span>) == <span class="string">&#x27;John says: Hi&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3-可观察的列表、映射和集"><a href="#3-3-可观察的列表、映射和集" class="headerlink" title="3.3 可观察的列表、映射和集"></a>3.3 可观察的列表、映射和集</h3><!-- Groovy comes with observable lists, maps and sets. Each of these collections trigger java.beans.PropertyChangeEvent events when elements are added, removed or changed. Note that a PropertyChangeEvent is not only signalling that a certain event has occurred, moreover, it holds information on the property name and the old/new value a certain property has been changed to. -->
<p>Groovy 还提供了可观察的列表、映射和集。这些集合在添加、移除或修改元素时都会触发 <code>java.beans.PropertyChangeEvent</code> 事件。值得注意的是一个 <code>PropertiChangeEvent</code> 并不只用于告诉监听器发生了特定的事件，它还包含了包括属性名以及属性修改前后的值等内容。</p>
<!-- Depending on the type of change that has happened, observable collections might fire more specialized PropertyChangeEvent types. For example, adding an element to an observable list fires an ObservableList.ElementAddedEvent event. -->
<p>根据所发生的修改的类型，可观察的集合甚至可以一次触发多个不同类型的 <code>PropertyChangeEvent</code> 事件。例如，向一个可观察的列表中添加一个元素会触发 <code>ObservableList.ElementAddedEvent</code> 事件：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> event                                       <span class="comment">// 注1</span></span><br><span class="line"><span class="keyword">def</span> listener = &#123;</span><br><span class="line">    <span class="keyword">if</span> (it <span class="keyword">instanceof</span> ObservableList.ElementEvent)  &#123;  <span class="comment">// 注2</span></span><br><span class="line">        event = it</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">as</span> PropertyChangeListener</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> observable = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] <span class="keyword">as</span> ObservableList    <span class="comment">// 注3</span></span><br><span class="line">observable.addPropertyChangeListener(listener)  <span class="comment">// 注4</span></span><br><span class="line"></span><br><span class="line">observable.add <span class="number">42</span>                               <span class="comment">// 注5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> event <span class="keyword">instanceof</span> ObservableList.ElementAddedEvent</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> elementAddedEvent = event <span class="keyword">as</span> ObservableList.ElementAddedEvent</span><br><span class="line"><span class="keyword">assert</span> elementAddedEvent.changeType == ObservableList.ChangeType.ADDED</span><br><span class="line"><span class="keyword">assert</span> elementAddedEvent.index == <span class="number">3</span></span><br><span class="line"><span class="keyword">assert</span> elementAddedEvent.oldValue == <span class="literal">null</span></span><br><span class="line"><span class="keyword">assert</span> elementAddedEvent.newValue == <span class="number">42</span></span><br></pre></td></tr></table></figure>

<ol>
<li>声明一个 <code>PropertyChangeEventListener</code> 用于捕获触发的事件</li>
<li><code>ObservableList.ElementEvent</code> 及其子类都会使该监听器起作用</li>
<li>注册监听器</li>
<li>用给定的列表创建一个 <code>ObservableList</code></li>
<li>触发一个 <code>ObservableList.ElementAddedEvent</code> 事件</li>
</ol>
<!-- Be aware that adding an element in fact causes two events to be triggered. The first is of type ObservableList.ElementAddedEvent, the second is a plain PropertyChangeEvent that informs listeners about the change of property size. -->
<p>注意，添加元素实际上会触发两个事件。第一个事件即为 <code>ObservableList.ElementAddedEvent</code>，而第二个实为一个 <code>PropertyChangeEvent</code>，用于告诉监听器列表的大小属性发生了变化。</p>
<!-- The ObservableList.ElementClearedEvent event type is another interesting one. Whenever multiple elements are removed, for example when calling clear(), it holds the elements being removed from the list. -->
<p><code>ObservableList.ElementClearedEvent</code> 则是另一种比较有意思的事件。当列表中的复数元素被移除，例如被调用了 <code>clear()</code> 方法时，它会包含所有被从列表中移除的元素：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> event</span><br><span class="line"><span class="keyword">def</span> listener = &#123;</span><br><span class="line">    <span class="keyword">if</span> (it <span class="keyword">instanceof</span> ObservableList.ElementEvent)  &#123;</span><br><span class="line">        event = it</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">as</span> PropertyChangeListener</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> observable = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] <span class="keyword">as</span> ObservableList</span><br><span class="line">observable.addPropertyChangeListener(listener)</span><br><span class="line"></span><br><span class="line">observable.clear()</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> event <span class="keyword">instanceof</span> ObservableList.ElementClearedEvent</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> elementClearedEvent = event <span class="keyword">as</span> ObservableList.ElementClearedEvent</span><br><span class="line"><span class="keyword">assert</span> elementClearedEvent.values == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">assert</span> observable.size() == <span class="number">0</span></span><br></pre></td></tr></table></figure>

<!-- To get an overview of all the supported event types the reader is encouraged to have a look at the JavaDoc documentation or the source code of the observable collection in use. -->
<p>为更好地了解所有支持的事件类型，读者可以参考所使用的可观察集合的 JavaDoc 文档或源代码。</p>
<!-- ObservableMap and ObservableSet come with the same concepts as we have seen for ObservableList in this section. -->
<p><code>ObservableMap</code> 和 <code>ObservableSet</code> 同样包含了在这节中我们所看到的 <code>ObservableList</code> 所包含的功能。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Groovy 教程 - GDK</p><p><a href="https://mr-dai.github.io/groovy-dev-kit/">https://mr-dai.github.io/groovy-dev-kit/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Robert Peng</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2018-04-24</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2018-04-24</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Groovy/">Groovy</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay-qrcode.png" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechat-qrcode.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/gradle-note/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Gradle 学习笔记</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/groovy-specification-1/"><span class="level-item">Groovy 语言规范 - 第一章：语法</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://mr-dai.github.io/groovy-dev-kit/';
            this.page.identifier = 'groovy-dev-kit/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'robertpsblog' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="呆呆"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">呆呆</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国广州</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">49</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">35</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://www.zhihu.com/people/robert.peng" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="知乎" href="https://www.zhihu.com/people/robert.peng"><i class="fab fa-zhihu"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Mr-Dai"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Bash/"><span class="tag">Bash</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bigtable/"><span class="tag">Bigtable</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GC/"><span class="tag">GC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go/"><span class="tag">Go</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Gradle/"><span class="tag">Gradle</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Groovy/"><span class="tag">Groovy</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HBase/"><span class="tag">HBase</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hadoop/"><span class="tag">Hadoop</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hive-ThriftServer/"><span class="tag">Hive ThriftServer</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JVM/"><span class="tag">JVM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MIT-6-824/"><span class="tag">MIT 6.824</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mesos/"><span class="tag">Mesos</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MongoDB/"><span class="tag">MongoDB</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Paxos/"><span class="tag">Paxos</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Raft/"><span class="tag">Raft</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQL/"><span class="tag">SQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spark/"><span class="tag">Spark</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spark-SQL/"><span class="tag">Spark SQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SparkSQL/"><span class="tag">SparkSQL</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows/"><span class="tag">Windows</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Yarn/"><span class="tag">Yarn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ZooKeeper/"><span class="tag">ZooKeeper</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/etcd/"><span class="tag">etcd</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B8%BB%E4%BB%8E%E5%A4%87%E4%BB%BD/"><span class="tag">主从备份</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B1%E8%AF%86/"><span class="tag">分布式共识</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%86%85%E5%AD%98/"><span class="tag">分布式内存</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/"><span class="tag">分布式存储</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"><span class="tag">分布式系统</span><span class="tag">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97/"><span class="tag">分布式计算</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C/"><span class="tag">团队协作</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9B%86%E7%BE%A4%E8%B5%84%E6%BA%90%E8%B0%83%E5%BA%A6/"><span class="tag">集群资源调度</span><span class="tag">2</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#1-I-O"><span class="level-left"><span class="level-item">1</span><span class="level-item">1 I/O</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-读取文件"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">1.1 读取文件</span></span></a></li><li><a class="level is-mobile" href="#1-2-写入文件"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">1.2 写入文件</span></span></a></li><li><a class="level is-mobile" href="#1-3-遍历文件树"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">1.3 遍历文件树</span></span></a></li><li><a class="level is-mobile" href="#1-4-数据与对象"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">1.4 数据与对象</span></span></a></li><li><a class="level is-mobile" href="#1-5-执行外部进程"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">1.5 执行外部进程</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-集合"><span class="level-left"><span class="level-item">2</span><span class="level-item">2 集合</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-列表"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">2.1 列表</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-1-列表字面量"><span class="level-left"><span class="level-item">2.1.1</span><span class="level-item">2.1.1 列表字面量</span></span></a></li><li><a class="level is-mobile" href="#2-1-2-将列表作为布尔表达式"><span class="level-left"><span class="level-item">2.1.2</span><span class="level-item">2.1.2 将列表作为布尔表达式</span></span></a></li><li><a class="level is-mobile" href="#2-1-3-遍历列表"><span class="level-left"><span class="level-item">2.1.3</span><span class="level-item">2.1.3 遍历列表</span></span></a></li><li><a class="level is-mobile" href="#2-1-4-过滤和查找"><span class="level-left"><span class="level-item">2.1.4</span><span class="level-item">2.1.4 过滤和查找</span></span></a></li><li><a class="level is-mobile" href="#2-1-5-添加和移除元素"><span class="level-left"><span class="level-item">2.1.5</span><span class="level-item">2.1.5 添加和移除元素</span></span></a></li><li><a class="level is-mobile" href="#2-1-6-集合操作"><span class="level-left"><span class="level-item">2.1.6</span><span class="level-item">2.1.6 集合操作</span></span></a></li><li><a class="level is-mobile" href="#2-1-7-排序"><span class="level-left"><span class="level-item">2.1.7</span><span class="level-item">2.1.7 排序</span></span></a></li><li><a class="level is-mobile" href="#2-1-8-复制元素"><span class="level-left"><span class="level-item">2.1.8</span><span class="level-item">2.1.8 复制元素</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-2-映射"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">2.2 映射</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-2-1-映射字面量"><span class="level-left"><span class="level-item">2.2.1</span><span class="level-item">2.2.1 映射字面量</span></span></a></li><li><a class="level is-mobile" href="#2-2-2-映射属性访问语句"><span class="level-left"><span class="level-item">2.2.2</span><span class="level-item">2.2.2 映射属性访问语句</span></span></a></li><li><a class="level is-mobile" href="#2-2-3-遍历映射"><span class="level-left"><span class="level-item">2.2.3</span><span class="level-item">2.2.3 遍历映射</span></span></a></li><li><a class="level is-mobile" href="#2-2-4-添加和删除元素"><span class="level-left"><span class="level-item">2.2.4</span><span class="level-item">2.2.4 添加和删除元素</span></span></a></li><li><a class="level is-mobile" href="#2-1-5-键、值与键值对"><span class="level-left"><span class="level-item">2.2.5</span><span class="level-item">2.1.5 键、值与键值对</span></span></a></li><li><a class="level is-mobile" href="#2-1-6-过滤与查找"><span class="level-left"><span class="level-item">2.2.6</span><span class="level-item">2.1.6 过滤与查找</span></span></a></li><li><a class="level is-mobile" href="#2-1-7-分组"><span class="level-left"><span class="level-item">2.2.7</span><span class="level-item">2.1.7 分组</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-3-区间"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">2.3 区间</span></span></a></li><li><a class="level is-mobile" href="#2-4-集合类的语法增强"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">2.4 集合类的语法增强</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-4-1-GPath-支持"><span class="level-left"><span class="level-item">2.4.1</span><span class="level-item">2.4.1 GPath 支持</span></span></a></li><li><a class="level is-mobile" href="#2-4-2-延伸运算符"><span class="level-left"><span class="level-item">2.4.2</span><span class="level-item">2.4.2 延伸运算符</span></span></a></li><li><a class="level is-mobile" href="#2-4-3-运算符"><span class="level-left"><span class="level-item">2.4.3</span><span class="level-item">2.4.3 *. 运算符</span></span></a></li><li><a class="level is-mobile" href="#2-4-4-使用下标运算符进行分割"><span class="level-left"><span class="level-item">2.4.4</span><span class="level-item">2.4.4 使用下标运算符进行分割</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-5-新添加的集合方法"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">2.5 新添加的集合方法</span></span></a></li></ul></li><li><a class="level is-mobile" href="#3-其他好用的功能"><span class="level-left"><span class="level-item">3</span><span class="level-item">3 其他好用的功能</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-1-ConfigSlurper"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">3.1 ConfigSlurper</span></span></a></li><li><a class="level is-mobile" href="#3-2-Expando"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">3.2 Expando</span></span></a></li><li><a class="level is-mobile" href="#3-3-可观察的列表、映射和集"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">3.3 可观察的列表、映射和集</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/avatar.png" alt="Robert Peng&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2021 Robert Peng</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="我的 Github" href="https://github.com/Mr-Dai"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>